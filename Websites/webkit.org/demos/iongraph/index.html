<!DOCTYPE html>

<head>
  <title>iongraph</title>
  <style>/* iongraph-specific styles inspired by Tachyons */

:root {
  --ig-size-1: 1rem;
  --ig-size-2: 2rem;
  --ig-size-3: 4rem;
  --ig-size-4: 8rem;
  --ig-size-5: 16rem;

  --ig-spacing-1: .25rem;
  --ig-spacing-2: .5rem;
  --ig-spacing-3: 1rem;
  --ig-spacing-4: 2rem;
  --ig-spacing-5: 4rem;
  --ig-spacing-6: 8rem;
  --ig-spacing-7: 16rem;

  --ig-text-color: black;
  --ig-text-color-dim: #777;
  --ig-background-primary: #ffb54e;
  --ig-background-light: white;
  --ig-border-color: #0c0c0d;

  --ig-block-header-color: #0c0c0d;
  --ig-loop-header-color: #1fa411;
  --ig-root-block-color: #1048af;
  --ig-movable-color: #1048af;
  --ig-rob-color: #444;
  --ig-in-worklist-color: red;

  --ig-block-selected: #ffc863;
  --ig-block-last-selected: #ffb54e;

  --ig-highlight-0: #ffb54e;
  --ig-highlight-1: #ffb5c5;
  --ig-highlight-2: #a4cbff;
  --ig-highlight-3: #8be182;
  --ig-highlight-4: #d9a4fd;

  --ig-flash-color: #ffb54e;

  /*
   * The heatmap of sample counts will effectively be sampled from a gradient:
   *
   * |----------|---------------------------------------|
   * cold     "cool"                                  hot
   *
   * The "cold" color will simply be transparent. Therefore, the "cool"
   * threshold indicates where the instruction will be fully colored and
   * noticeable to the user.
   */
  --ig-hot-color: #ff849e;
  --ig-cool-color: #ffe546;
  --ig-cool-threshold: 0.2;
}

a.ig-link-normal {
  color: inherit;
  text-decoration: inherit;
}

.ig-flex {
  display: flex;
}

.ig-flex-column {
  flex-direction: column;
}

.ig-flex-basis-0 {
  flex-basis: 0;
}

.ig-flex-grow-1 {
  flex-grow: 1;
}

.ig-flex-shrink-0 {
  flex-shrink: 0;
}

.ig-flex-shrink-1 {
  flex-shrink: 1;
}

.ig-items-center {
  align-items: center;
}

.ig-relative {
  position: relative;
}

.ig-absolute {
  position: absolute;
}

.ig-absolute-fill {
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}

.ig-g1 {
  gap: var(--ig-spacing-1);
}

.ig-g2 {
  gap: var(--ig-spacing-2);
}

.ig-g3 {
  gap: var(--ig-spacing-3);
}

.ig-w1 {
  width: var(--ig-size-1);
}

.ig-w2 {
  width: var(--ig-size-2);
}

.ig-w3 {
  width: var(--ig-size-3);
}

.ig-w4 {
  width: var(--ig-size-4);
}

.ig-w5 {
  width: var(--ig-size-5);
}

.ig-w-100 {
  width: 100%;
}

.ig-ba {
  border-style: solid;
  border-width: 1px;
  border-color: var(--ig-border-color);
}

.ig-bt {
  border-top-style: solid;
  border-top-width: 1px;
  border-color: var(--ig-border-color);
}

.ig-br {
  border-right-style: solid;
  border-right-width: 1px;
  border-color: var(--ig-border-color);
}

.ig-bb {
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-color: var(--ig-border-color);
}

.ig-bl {
  border-left-style: solid;
  border-left-width: 1px;
  border-color: var(--ig-border-color);
}

.ig-pa1 {
  padding: var(--ig-spacing-1);
}

.ig-pa2 {
  padding: var(--ig-spacing-2);
}

.ig-pa3 {
  padding: var(--ig-spacing-3);
}

.ig-ph1 {
  padding-left: var(--ig-spacing-1);
  padding-right: var(--ig-spacing-1);
}

.ig-ph2 {
  padding-left: var(--ig-spacing-2);
  padding-right: var(--ig-spacing-2);
}

.ig-ph3 {
  padding-left: var(--ig-spacing-3);
  padding-right: var(--ig-spacing-3);
}

.ig-pv1 {
  padding-top: var(--ig-spacing-1);
  padding-bottom: var(--ig-spacing-1);
}

.ig-pv2 {
  padding-top: var(--ig-spacing-2);
  padding-bottom: var(--ig-spacing-2);
}

.ig-pv3 {
  padding-top: var(--ig-spacing-3);
  padding-bottom: var(--ig-spacing-3);
}

.ig-pt1 {
  padding-top: var(--ig-spacing-1);
}

.ig-pt2 {
  padding-top: var(--ig-spacing-2);
}

.ig-pt3 {
  padding-top: var(--ig-spacing-3);
}

.ig-pr1 {
  padding-right: var(--ig-spacing-1);
}

.ig-pr2 {
  padding-right: var(--ig-spacing-2);
}

.ig-pr3 {
  padding-right: var(--ig-spacing-3);
}

.ig-pb1 {
  padding-bottom: var(--ig-spacing-1);
}

.ig-pb2 {
  padding-bottom: var(--ig-spacing-2);
}

.ig-pb3 {
  padding-bottom: var(--ig-spacing-3);
}

.ig-pl1 {
  padding-left: var(--ig-spacing-1);
}

.ig-pl2 {
  padding-left: var(--ig-spacing-2);
}

.ig-pl3 {
  padding-left: var(--ig-spacing-3);
}

.ig-f1 {
  font-size: 3rem;
}

.ig-f2 {
  font-size: 2.25rem;
}

.ig-f3 {
  font-size: 1.5rem;
}

.ig-f4 {
  font-size: 1.25rem;
}

.ig-f5 {
  font-size: 1rem;
}

.ig-f6 {
  font-size: .875rem;
}

.ig-f7 {
  font-size: .75rem;
}

.ig-text-normal {
  color: var(--ig-text-color);
}

.ig-text-dim {
  color: var(--ig-text-color-dim);
}

.ig-tl {
  text-align: left;
}

.ig-tr {
  text-align: right;
}

.ig-tc {
  text-align: center;
}

.ig-bg-white {
  background-color: var(--ig-background-light);
}

.ig-bg-primary {
  background-color: var(--ig-background-primary);
}

.ig-overflow-hidden {
  overflow: hidden;
}

.ig-overflow-auto {
  overflow: auto;
}

.ig-overflow-x-auto {
  overflow-x: auto;
}

.ig-overflow-y-auto {
  overflow-y: auto;
}

.ig-hide-if-empty:empty {
  display: none;
}

/* Non-utility styles */

.ig-graph {
  color: var(--ig-text-color);
  position: absolute;
  left: 0;
  top: 0;
  isolation: isolate;
}

.ig-block {
  position: absolute;

  .ig-block-header {
    font-weight: bold;
    text-align: center;
    background-color: var(--ig-block-header-color);
    color: white;
    padding: 0 1em;
    border: 1px solid var(--ig-border-color);
    border-width: 1px 1px 0;
  }

  .ig-instructions {
    padding: 0.5em;
    border: 1px solid var(--ig-border-color);
    border-width: 0 1px 1px;

    table {
      border-collapse: collapse;
    }

    td,
    th {
      white-space: nowrap;
      padding: 0.1em 0.5em;
    }

    th {
      font-weight: normal;
    }
  }

  &.ig-selected {
    outline: 4px solid var(--ig-block-selected);
  }

  &.ig-last-selected {
    outline-color: var(--ig-block-last-selected);
  }
}

.ig-block-att-loopheader {
  .ig-block-header {
    background-color: var(--ig-loop-header-color);
  }
}

.ig-block-att-root {
  .ig-block-header {
    background-color: var(--ig-root-block-color);
  }
}

.ig-block-att-splitedge {
  .ig-instructions {
    border-style: dotted;
    border-width: 0 2px 2px;
  }
}

.ig-ins-num {
  text-align: right;
  cursor: pointer;
}

.ig-ins-type {
  text-align: right;
}

.ig-ins-samples {
  font-size: 0.875em;
  text-align: right;
  cursor: pointer;
}

.ig-use {
  padding: 0 0.25em;
  border-radius: 2px;
  cursor: pointer;
}

.ig-edge-label {
  position: absolute;
  font-size: 0.8em;
  line-height: 1;
  bottom: -1em;
  padding-left: 4px;
}

.ig-ins-att-RecoveredOnBailout {
  color: var(--ig-rob-color);
}

.ig-ins-att-Movable {
  color: var(--ig-movable-color);
}

.ig-ins-att-Guard {
  text-decoration: underline;
}

.ig-ins-att-InWorklist {
  color: var(--ig-in-worklist-color);
}

.ig-can-flash {
  transition: outline-color 1s ease-out;
  outline: 3px solid color-mix(in srgb, var(--ig-flash-color) 0%, transparent);
}

.ig-flash {
  transition: outline-color 0s;
  outline-color: var(--ig-flash-color);
}

.ig-hotness {
  --ig-hotness: 0;

  --ig-cold-color: color-mix(in srgb, var(--ig-cool-color) 20%, transparent);
  background-color:
    /* cool <-> hot */
    color-mix(in oklab,
      /* cold <-> cool */
      color-mix(in oklab,
        /* dead or cold */
        color-mix(in srgb, transparent, var(--ig-cold-color) clamp(0%, calc(var(--ig-hotness) * 100000000%), 100%)),
        var(--ig-cool-color) clamp(0%, calc((var(--ig-hotness) / var(--ig-cool-threshold)) * 100%), 100%)),
      var(--ig-hot-color) clamp(0%, calc(((var(--ig-hotness) - var(--ig-cool-threshold)) / (1 - var(--ig-cool-threshold))) * 100%), 100%));
}

.ig-highlight {
  --ig-highlight-color: transparent;
  background-color: var(--ig-highlight-color);
}</style>
  <style>* {
  box-sizing: border-box;
}

:root {
  font-size: 0.875rem;
}

body {
  margin: 0;
  background-color: #e5e8ea;
  /* Font, and many other styles, taken from the Firefox Profiler/ */
  font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen-Sans, Ubuntu, Noto Sans, Liberation Sans, Cantarell, Helvetica Neue, sans-serif;
}

#container {
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
}

.tweaks-panel {
  position: absolute;
  bottom: 0;
  right: 0;
  padding: 1rem;
  border: 1px solid black;
  border-width: 1px 0 0 1px;
  background-color: white;
}</style>
</head>

<body>
  <script>"use strict";var iongraph=(()=>{var _=Object.defineProperty;var ct=Object.getOwnPropertyDescriptor;var dt=Object.getOwnPropertyNames;var ht=Object.prototype.hasOwnProperty;var ut=(a,t)=>{for(var e in t)_(a,e,{get:t[e],enumerable:!0})},pt=(a,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of dt(t))!ht.call(a,o)&&o!==e&&_(a,o,{get:()=>t[o],enumerable:!(s=ct(t,o))||s.enumerable});return a};var mt=a=>pt(_({},"__esModule",{value:!0}),a);var Dt={};ut(Dt,{StandaloneUI:()=>q,WebUI:()=>U});function j(a){a.version===void 0&&(a.version=0);for(let t of a.functions)ft(t,a.version);return a.version=1,a}function ft(a,t){for(let e of a.passes){for(let s of e.mir.blocks)gt(s,t);for(let s of e.lir.blocks)kt(s,t)}return a}function gt(a,t){t===0&&(a.ptr=(a.id??a.number)+1,a.id=a.number);for(let e of a.instructions)bt(e,t);return a}function bt(a,t){return t===0&&(a.ptr=a.id),a}function kt(a,t){t===0&&(a.ptr=a.id??a.number,a.id=a.number);for(let e of a.instructions)yt(e,t);return a}function yt(a,t){return t===0&&(a.ptr=a.id,a.mirPtr=null),a}function V(a,t,e){return Math.max(t,Math.min(e,a))}function A(a,t,e,s){return(a-t)*Math.pow(e,s)+t}function w(a,t,e=!1){if(!a)if(e)console.error(t??"Assertion failed");else throw new Error(t??"Assertion failed")}function I(a,t){return w(a,t),a}function xt(a){return typeof a=="string"?document.createTextNode(a):a}function wt(a,t){for(let e of t)e&&a.appendChild(xt(e))}function b(a,t,e,s){let o=document.createElement(a);if(t&&t.length>0){let n=t.filter(r=>!!r);o.classList.add(...n)}return e?.(o),s&&wt(o,s),o}var K=Object.prototype.hasOwnProperty;function C(a,t){var e,s;if(a===t)return!0;if(a&&t&&(e=a.constructor)===t.constructor){if(e===Date)return a.getTime()===t.getTime();if(e===RegExp)return a.toString()===t.toString();if(e===Array){if((s=a.length)===t.length)for(;s--&&C(a[s],t[s]););return s===-1}if(!e||typeof a=="object"){s=0;for(e in a)if(K.call(a,e)&&++s&&!K.call(t,e)||!(e in t)||!C(a[e],t[e]))return!1;return Object.keys(t).length===s}}return a!==a&&t!==t}function B(a,t,e={}){let s=t,o=[],n={get(){return s},set(r){s=r;for(let i of o)i(s)},valueOf(){return s},toString(){return String(s)},[Symbol.toPrimitive](r){return r==="string"?String(s):s},onChange(r){o.push(r)},initial:t,name:a,min:e.min??0,max:e.max??100,step:e.step??1};return(e.tweaksObject??G).add(n)}var O=class{constructor(t){this.container=t.container,this.tweaks=[],this.callbacks=[]}add(t){let e=this.tweaks.find(c=>c.name===t.name);if(e)return e;this.tweaks.push(t);let s=document.createElement("div");this.container.appendChild(s),s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="end",s.style.gap="0.5rem";let o=t.name.replace(/[a-zA-Z0-9]/g,"_"),n=document.createElement("label");s.appendChild(n),n.innerText=t.name,n.htmlFor=`tweak-${o}-input`;let r=document.createElement("input");s.appendChild(r),r.type="number",r.value=String(t),r.id=`tweak-${o}-input`,r.style.width="4rem",r.addEventListener("input",()=>{t.set(r.valueAsNumber)});let i=document.createElement("input");s.appendChild(i),i.type="range",i.value=String(t),i.min=String(t.min),i.max=String(t.max),i.step=t.step===0?"any":String(t.step),i.addEventListener("input",()=>{t.set(i.valueAsNumber)});let l=document.createElement("button");return s.appendChild(l),l.innerText="Reset",l.disabled=t.get()===t.initial,l.addEventListener("click",()=>{t.set(t.initial)}),t.onChange(c=>{r.value=String(c),i.value=String(c),l.disabled=t.get()===t.initial;for(let h of this.callbacks)h(t)}),t}onTweak(t){this.callbacks.push(t)}},W=document.createElement("div");W.classList.add("tweaks-panel");var G=new O({container:W});G.onTweak(a=>{window.dispatchEvent(new CustomEvent("tweak",{detail:a}))});window.tweaks=G;var vt=document.createElement("div"),Pt=new O({container:vt}),Q=B("Test Value",3,{tweaksObject:Pt});Q.set(4);Q=4;var it=B("Debug?",0,{min:0,max:1}),L=20,N=44,v=16,T=60,$=12,M=36,tt=16;var Lt=40,It=B("Layout Iterations",2,{min:0,max:6}),et=B("Nearly Straight Threshold",30,{min:0,max:200}),Bt=B("Nearly Straight Iterations",8,{min:0,max:10}),Tt=B("Stop At Pass",30,{min:0,max:30}),St=1.5,Ct=.01,Nt=1,Mt=.1,R=40,J=1,st=2,nt=4,E=0,Y=1,D=new Proxy(console,{get(a,t){let e=a[t];return typeof e!="function"?e:+it?e.bind(a):()=>{}}}),F=class{constructor(t,e,s={}){this.stabilizationTimeout=null;this.layoutFinalized=!1;this.deferredJumpToBlock=null;this.viewport=t;let o=t.getBoundingClientRect();this.viewportSize={x:o.width,y:o.height},this.graphContainer=document.createElement("div"),this.graphContainer.classList.add("ig-graph"),this.graphContainer.style.transformOrigin="top left",this.viewport.appendChild(this.graphContainer),this.sampleCounts=s.sampleCounts,this.maxSampleCounts=[0,0],this.heatmapMode=E;for(let[n,r]of this.sampleCounts?.totalLineHits??[])this.maxSampleCounts[E]=Math.max(this.maxSampleCounts[E],r);for(let[n,r]of this.sampleCounts?.selfLineHits??[])this.maxSampleCounts[Y]=Math.max(this.maxSampleCounts[Y],r);this.size={x:0,y:0},this.numLayers=0,this.zoom=1,this.translation={x:0,y:0},this.animating=!1,this.targetZoom=1,this.targetTranslation={x:0,y:0},this.startMousePos={x:0,y:0},this.lastMousePos={x:0,y:0},this.selectedBlockPtrs=new Set,this.lastSelectedBlockPtr=0,this.nav={visited:[],currentIndex:-1,siblings:[]},this.highlightedInstructions=[],this.instructionPalette=s.instructionPalette??[0,1,2,3,4].map(n=>`var(--ig-highlight-${n})`),this.blocks=e.mir.blocks.map(n=>{let r={ptr:n.ptr,id:n.id,mir:n,lir:e.lir.blocks.find(i=>i.id===n.id)??null,preds:[],succs:[],el:void 0,size:{x:0,y:0},layer:-1,layoutNode:void 0,isLoopHeader:!1,isBackedge:!1,isRoot:!1,isOSRTarget:!1,isCatchEntrypoint:!1};return w(r.ptr,"blocks must always have non-null ptrs"),r}),this.blocksByID=new Map,this.blocksByPtr=new Map,this.insPtrsByID=new Map,this.insIDsByPtr=new Map;for(let n of this.blocks){this.blocksByID.set(n.id,n),this.blocksByPtr.set(n.ptr,n);for(let r of n.mir.instructions)this.insPtrsByID.set(r.id,r.ptr),this.insIDsByPtr.set(r.ptr,r.id);if(n.lir)for(let r of n.lir.instructions)this.insPtrsByID.set(r.id,r.ptr),this.insIDsByPtr.set(r.ptr,r.id)}for(let n of this.blocks)n.preds=n.mir.predecessors.map(r=>I(this.blocksByID.get(r))),n.succs=n.mir.successors.map(r=>I(this.blocksByID.get(r))),n.isRoot=n.preds.length===0,n.isOSRTarget=n.mir.attributes.includes("osr"),n.isCatchEntrypoint=n.mir.attributes.includes("catch");this.assignLayers();for(let n of this.blocks)n.el=this.renderBlock(n);for(let n of this.blocks)n.size={x:n.el.offsetWidth,y:n.el.offsetHeight};this.runLayout(),this.stabilizationTimeout=window.setTimeout(()=>{this.stabilizationTimeout=null;let n=!1;for(let r of this.blocks){let i=r.el.offsetWidth,l=r.el.offsetHeight;(Math.abs(r.size.x-i)>1||Math.abs(r.size.y-l)>1)&&(r.size={x:i,y:l},n=!0)}n&&this.runLayout(),this.layoutFinalized=!0,D.log("Graph layout finalized.")},100),this.addEventListeners()}runLayout(){let[t,e,s]=this.layout(),o=Array.from(this.graphContainer.children);for(let n of o)n.classList.contains("ig-block")||n.remove();if(this.render(t,e,s),this.deferredJumpToBlock){let{blockPtr:n,opts:r}=this.deferredJumpToBlock;this.deferredJumpToBlock=null,this.jumpToBlock(n,r)}}layout(){let t=this.makeLayoutNodes();this.straightenEdges(t);let e=this.finagleJoints(t),s=this.verticalize(t,e);return[t,s,e]}findLayoutRoots(){let t=[],e=[],s=this.blocks.filter(o=>o.preds.length===0);for(let o of s)t.push(o),o.mir.attributes.includes("osr")&&e.push(o);if(t.length===0&&this.blocks.length>0){let o=[...this.blocks].sort((n,r)=>n.id-r.id);t.push(o[0])}return[t,e]}detectCycles(){let t=new Map,e=new Map,s=o=>{t.set(o,1);for(let n of o.succs){let r=t.get(n)??0;if(r===1){let i=e.get(o);i||(i=new Set,e.set(o,i)),i.add(n),o.isBackedge=!0,n.isLoopHeader=!0}else r===0&&s(n)}t.set(o,2)};for(let o of this.blocks)t.has(o)||s(o);return e}assignLayers(){let t=this.detectCycles();for(let o of this.blocks)o.layer=-1;let e=o=>{if(o.layer!==-1)return o.layer;let n=-1;for(let r of o.preds){let i=t.get(r);if(i&&i.has(o))continue;let l=e(r);l>n&&(n=l)}return o.layer=n+1,o.layer},s=0;for(let o of this.blocks){let n=e(o);n>s&&(s=n)}this.numLayers=s+1,D.log(`Assigned generic layers. Max layer: ${s}`)}makeLayoutNodes(){D.group("makeLayoutNodes");function t(i,l,c){i.dstNodes[l]=c,c.srcNodes.includes(i)||c.srcNodes.push(i)}let e;{let i={};for(let l of this.blocks){let c=l.layer<0?0:l.layer;i[c]||(i[c]=[]),i[c].push(l)}e=Object.entries(i).map(([l,c])=>[Number(l),c]).sort((l,c)=>l[0]-c[0]).map(([l,c])=>c)}let s=[];for(let i=0;i<this.numLayers;i++)s[i]=e.find(l=>l[0]?.layer===i)||[];let o=0,n=s.map(()=>[]),r=[];for(let[i,l]of s.entries()){let c=[];for(let d of l)for(let u=r.length-1;u>=0;u--){let p=r[u];p.dstBlock===d&&(c.unshift(p),r.splice(u,1))}let h=new Map;for(let d of r){let u=h.get(d.dstBlock.id);u?t(d.src,d.srcPort,u):(u={id:o++,pos:{x:L,y:L},size:{x:0,y:0},block:null,srcNodes:[],dstNodes:[],dstBlock:d.dstBlock,jointOffsets:[],flags:0},t(d.src,d.srcPort,u),n[i].push(u),h.set(d.dstBlock.id,u)),d.src=u,d.srcPort=0}for(let d of l){let u={id:o++,pos:{x:L,y:L},size:d.size,block:d,srcNodes:[],dstNodes:[],jointOffsets:[],flags:0};d.layoutNode=u,n[i].push(u);for(let p of c)p.dstBlock===d&&t(p.src,p.srcPort,u)}for(let d of l)d.succs.forEach((u,p)=>{if(u.layer>i)u.layer===i+1?r.push({src:d.layoutNode,srcPort:p,dstBlock:u}):r.push({src:d.layoutNode,srcPort:p,dstBlock:u});else{let m=i,f=u.layer,g=d.layoutNode,y=p;for(let x=m;x>=f;x--){let k={id:o++,pos:{x:L,y:L},size:{x:0,y:0},block:null,srcNodes:[],dstNodes:[],dstBlock:u,jointOffsets:[],flags:nt};n[x].push(k),t(g,y,k),g=k,y=0}u.layoutNode&&t(g,y,u.layoutNode)}})}for(let i of n){for(let l=0;l<i.length&&i[l].block===null;l++)i[l].flags|=J;for(let l=i.length-1;l>=0&&i[l].block===null;l--)i[l].flags|=st}return D.groupEnd(),n}straightenEdges(t){let e=d=>{for(let u=0;u<d.length-1;u++){let p=d[u],m=d[u+1],f=p.block===null&&m.block!==null,g=p.pos.x+p.size.x+(f?v:0)+N;m.pos.x=Math.max(m.pos.x,g)}},s=()=>{let d=new Map;for(let u of Z(t)){let p=u.dstBlock,m=u.pos.x;d.set(p,Math.max(d.get(p)??0,m))}for(let u of Z(t)){let p=u.dstBlock,m=d.get(p);m&&(u.pos.x=m)}for(let u of t)e(u)},o=()=>{let d=new Map;for(let u of t){let p=0,m=0;for(;p<u.length;p++)if(!(u[p].flags&J)){m=u[p].pos.x;break}for(p-=1,m-=N+v;p>=0;p--){let f=u[p],g=m;for(let y of f.srcNodes){let x=y.pos.x+y.dstNodes.indexOf(f)*T;x<g&&(g=x)}f.pos.x=g,m=f.pos.x-N,d.set(f.dstBlock,Math.min(d.get(f.dstBlock)??1/0,g))}}for(let u of Z(t)){if(!(u.flags&J))continue;let p=d.get(u.dstBlock);p&&(u.pos.x=p)}},n=()=>{for(let d=0;d<t.length-1;d++){let u=t[d];e(u);let p=-1;for(let m of u)for(let[f,g]of m.dstNodes.entries()){if(!t[d+1].includes(g))continue;let y=t[d+1].indexOf(g);if(y>p&&g.srcNodes[0]===m){let x=v+T*f,k=v,P=g.pos.x;g.pos.x=Math.max(g.pos.x,m.pos.x+x-k),g.pos.x!==P&&(p=y)}}}},r=()=>{for(let d of t){for(let u=d.length-1;u>=0;u--){let p=d[u];if(!p.block||p.block.isLoopHeader)continue;let m=[];for(let f of p.srcNodes){let g=v+f.dstNodes.indexOf(p)*T,y=v;m.push(f.pos.x+g-(p.pos.x+y))}for(let[f,g]of p.dstNodes.entries()){if(g.block===null&&g.dstBlock.isLoopHeader)continue;let y=v+f*T,x=v;m.push(g.pos.x+x-(p.pos.x+y))}if(!m.includes(0)){m=m.filter(f=>f>0).sort((f,g)=>f-g);for(let f of m){let g=!1;for(let y=u+1;y<d.length;y++){let x=d[y];if(x.flags&st)continue;let k=p.pos.x+f,P=p.pos.x+f+p.size.x,at=x.pos.x-N,lt=x.pos.x+x.size.x+N;P>=at&&k<=lt&&(g=!0)}if(!g){p.pos.x+=f;break}}}}e(d)}},i=()=>{for(let d=t.length-1;d>=0;d--){let u=t[d];e(u);for(let p of u)for(let m of p.srcNodes){if(m.block!==null)continue;Math.abs(m.pos.x-p.pos.x)<=et&&(m.pos.x=Math.max(m.pos.x,p.pos.x),p.pos.x=Math.max(m.pos.x,p.pos.x))}}},l=()=>{for(let d=0;d<t.length;d++){let u=t[d];e(u);for(let p of u){if(p.dstNodes.length===0)continue;let m=p.dstNodes[0];if(m.block!==null)continue;Math.abs(m.pos.x-p.pos.x)<=et&&(m.pos.x=Math.max(m.pos.x,p.pos.x),p.pos.x=Math.max(m.pos.x,p.pos.x))}}};function c(d,u){let p=[];for(let m=0;m<u;m++)for(let f of d)p.push(f);return p}let h=[...c([n,s],It),s,...c([i,l],Bt),r,s,o];for(let[d,u]of h.entries())d<Tt&&u()}finagleJoints(t){let e=[];for(let s of t){let o=[];for(let c of s){c.jointOffsets=new Array(c.dstNodes.length).fill(0);for(let[h,d]of c.dstNodes.entries()){if(d.pos.y<c.pos.y)continue;let u=c.pos.x+v+T*h,p=d.pos.x+v;Math.abs(p-u)<2*$||o.push({x1:u,x2:p,src:c,srcPort:h,dst:d})}}o.sort((c,h)=>c.x1-h.x1);let n=[],r=[];t:for(let c of o){let h=c.x2-c.x1>=0?n:r,d=null;for(let u=h.length-1;u>=0;u--){let p=h[u],m=!1;for(let f of p){if(c.dst===f.dst){p.push(c);continue t}let g=Math.min(c.x1,c.x2),y=Math.max(c.x1,c.x2),x=Math.min(f.x1,f.x2),k=Math.max(f.x1,f.x2);if(y>=x&&g<=k){m=!0;break}}if(m)break;d=p}d?d.push(c):h.push([c])}let i=Math.max(0,n.length+r.length-1)*tt,l=-i/2;for(let c of[...n.reverse(),...r]){for(let h of c)h.src.jointOffsets[h.srcPort]=l;l+=tt}e.push(i)}return e}verticalize(t,e){let s=new Array(t.length),o=L;for(let n=0;n<t.length;n++){let r=t[n],i=0;for(let l of r)l.pos.y=o,i=Math.max(i,l.size.y);s[n]=i,o+=i+M+e[n]+M}return s}renderBlock(t){let e=document.createElement("div");this.graphContainer.appendChild(e),e.classList.add("ig-block","ig-bg-white");for(let i of t.mir.attributes)e.classList.add(`ig-block-att-${i}`);e.setAttribute("data-ig-block-ptr",`${t.ptr}`),e.setAttribute("data-ig-block-id",`${t.id}`);let s=[];t.isRoot&&(s.push("(root)"),e.classList.add("ig-block-att-root")),t.isCatchEntrypoint&&s.push("(catch)"),t.isOSRTarget&&s.push("(osr)"),t.isLoopHeader&&(s.push("(loop header)"),e.classList.add("ig-block-att-loopheader")),t.isBackedge&&(s.push("(backedge)"),e.classList.add("ig-block-att-backedge"));let o=document.createElement("div");o.classList.add("ig-block-header"),o.innerText=`Block ${t.id}${s.length===0?"":" "+s.join(" ")}`,e.appendChild(o);let n=document.createElement("div");n.classList.add("ig-instructions"),e.appendChild(n);let r=document.createElement("table");if(t.lir){r.innerHTML=`
        <colgroup>
          <col style="width: 1px">
          <col style="width: auto">
          ${this.sampleCounts?`
            <col style="width: 1px">
            <col style="width: 1px">
          `:""}
        </colgroup>
        ${this.sampleCounts?`
          <thead>
            <tr>
              <th></th>
              <th></th>
              <th class="ig-f6">Total</th>
              <th class="ig-f6">Self</th>
            </tr>
          </thead>
        `:""}
      `;for(let i of t.lir.instructions)r.appendChild(this.renderLIRInstruction(i))}else{r.innerHTML=`
        <colgroup>
          <col style="width: 1px">
          <col style="width: auto">
          <col style="width: 1px">
        </colgroup>
      `;for(let i of t.mir.instructions)r.appendChild(this.renderMIRInstruction(i))}n.appendChild(r);for(let[i,l]of t.succs.entries()){let c=document.createElement("div");c.innerText=`#${l.id}`,c.classList.add("ig-edge-label"),c.style.left=`${v+T*i}px`,e.appendChild(c)}return o.addEventListener("pointerdown",i=>{i.preventDefault(),i.stopPropagation()}),o.addEventListener("click",i=>{i.stopPropagation(),i.shiftKey||this.selectedBlockPtrs.clear(),this.setSelection([],t.ptr)}),e}render(t,e,s){for(let l of t)for(let c of l)if(c.block!==null){let h=c.block;h.el.style.left=`${c.pos.x}px`,h.el.style.top=`${c.pos.y}px`}let o=0,n=0;for(let l of t)for(let c of l)o=Math.max(o,c.pos.x+c.size.x+L),n=Math.max(n,c.pos.y+c.size.y+L);let r=document.createElementNS("http://www.w3.org/2000/svg","svg");this.graphContainer.appendChild(r);let i=(l,c)=>{for(let h of l)o=Math.max(o,h+L);for(let h of c)n=Math.max(n,h+L)};for(let l=0;l<t.length;l++){let c=t[l];for(let h of c){w(h.dstNodes.length===h.jointOffsets.length,"must have a joint offset for each destination");for(let[d,u]of h.dstNodes.entries()){let p=h.pos.x+v+T*d,m=h.pos.y+h.size.y,f=u.pos.x+v,g=u.pos.y,y=g<m,x=k=>(k.flags&nt)!==0;if(h.block&&u.block===null&&y){let k=m+M,P=Ht(p,m,f,g,k);r.appendChild(P),i([p,f],[m,g,k])}else if(h.block===null&&u.block!==null&&Math.abs(m-g)<1){let k=g-Lt,P=At(p,m,f,g,k);r.appendChild(P),i([p,f],[m,g,k])}else if(y){let k=m-M,P=$t(p,m,f,g,k,u.block!==null);r.appendChild(P),i([p,f],[m,g,k])}else{let k=m-h.size.y+e[l]+M+s[l]/2+h.jointOffsets[d],P=Et(p,m,f,g,k,u.block!==null);r.appendChild(P),i([p,f],[m,g,k])}}}}if(r.setAttribute("width",`${o}`),r.setAttribute("height",`${n}`),this.size={x:o,y:n},+it)for(let l of t)for(let c of l){let h=document.createElement("div");h.appendChild(document.createTextNode(String(c.id))),h.appendChild(document.createElement("br")),h.appendChild(document.createTextNode(`L:${c.block?.layer}`)),h.appendChild(document.createElement("br")),h.appendChild(document.createTextNode(`<- ${c.srcNodes.map(d=>d.id)}`)),h.appendChild(document.createElement("br")),h.appendChild(document.createTextNode(`-> ${c.dstNodes.map(d=>d.id)}`)),h.style.position="absolute",h.style.border="1px solid black",h.style.backgroundColor="white",h.style.left=`${c.pos.x}px`,h.style.top=`${c.pos.y}px`,h.style.whiteSpace="nowrap",this.graphContainer.appendChild(h)}this.updateHighlightedInstructions(),this.updateHotness()}renderMIRInstruction(t){let e=t.opcode.replace("->","\u2192").replace("<-","\u2190"),s=document.createElement("tr");s.classList.add("ig-ins","ig-ins-mir","ig-can-flash",...t.attributes.map(h=>`ig-ins-att-${h}`)),s.setAttribute("data-ig-ins-ptr",`${t.ptr}`),s.setAttribute("data-ig-ins-id",`${t.id}`);let o=document.createElement("td");o.classList.add("ig-ins-num"),o.innerText=String(t.id),s.appendChild(o);let n=document.createElement("td"),r=/([A-Za-z0-9_<>]+)#(\d+)/g,i=0,l;for(;(l=r.exec(e))!==null;){if(l.index>i){let d=e.substring(i,l.index);n.appendChild(document.createTextNode(d))}let h=document.createElement("span");h.className="ig-use ig-highlightable",h.setAttribute("data-ig-use",encodeURIComponent(l[2])),h.textContent=`${l[1]}#${l[2]}`,n.appendChild(h),i=r.lastIndex}if(i<e.length){let h=e.substring(i);n.appendChild(document.createTextNode(h))}s.appendChild(n);let c=document.createElement("td");return c.classList.add("ig-ins-type"),c.innerText=t.type==="None"?"":t.type,s.appendChild(c),o.addEventListener("pointerdown",h=>{h.preventDefault(),h.stopPropagation()}),o.addEventListener("click",()=>{this.toggleInstructionHighlight(t.ptr)}),n.querySelectorAll(".ig-use").forEach(h=>{h.addEventListener("pointerdown",d=>{d.preventDefault(),d.stopPropagation()}),h.addEventListener("click",d=>{let u=parseInt(I(h.getAttribute("data-ig-use")),10);this.jumpToInstruction(u,{zoom:1})})}),s}renderLIRInstruction(t){let e=t.opcode.replace("->","\u2192").replace("<-","\u2190"),s=document.createElement("tr");s.classList.add("ig-ins","ig-ins-lir","ig-hotness"),s.setAttribute("data-ig-ins-ptr",`${t.ptr}`),s.setAttribute("data-ig-ins-id",`${t.id}`);let o=document.createElement("td");o.classList.add("ig-ins-num"),o.innerText=String(t.id),s.appendChild(o);let n=document.createElement("td");if(n.innerText=e,s.appendChild(n),this.sampleCounts){let r=this.sampleCounts?.totalLineHits.get(t.id)??0,i=this.sampleCounts?.selfLineHits.get(t.id)??0,l=document.createElement("td");l.classList.add("ig-ins-samples"),l.classList.toggle("ig-text-dim",r===0),l.innerText=`${r}`,l.title="Color by total count",s.appendChild(l);let c=document.createElement("td");c.classList.add("ig-ins-samples"),c.classList.toggle("ig-text-dim",i===0),c.innerText=`${i}`,c.title="Color by self count",s.appendChild(c);for(let[h,d]of[l,c].entries())d.addEventListener("pointerdown",u=>{u.preventDefault(),u.stopPropagation()}),d.addEventListener("click",()=>{w(h===E||h===Y),this.heatmapMode=h,this.updateHotness()})}return o.addEventListener("pointerdown",r=>{r.preventDefault(),r.stopPropagation()}),o.addEventListener("click",()=>{this.toggleInstructionHighlight(t.ptr)}),s}renderSelection(){this.graphContainer.querySelectorAll(".ig-block").forEach(t=>{let e=parseInt(I(t.getAttribute("data-ig-block-ptr")),10);t.classList.toggle("ig-selected",this.selectedBlockPtrs.has(e)),t.classList.toggle("ig-last-selected",this.lastSelectedBlockPtr===e)})}removeNonexistentHighlights(){this.highlightedInstructions=this.highlightedInstructions.filter(t=>this.graphContainer.querySelector(`.ig-ins[data-ig-ins-ptr="${t.ptr}"]`))}updateHighlightedInstructions(){for(let t of this.highlightedInstructions)w(this.highlightedInstructions.filter(e=>e.ptr===t.ptr).length===1,`instruction ${t.ptr} was highlighted more than once`);this.graphContainer.querySelectorAll(".ig-ins, .ig-use").forEach(t=>{Ot(t)});for(let t of this.highlightedInstructions){let e=this.instructionPalette[t.paletteColor%this.instructionPalette.length],s=this.graphContainer.querySelector(`.ig-ins[data-ig-ins-ptr="${t.ptr}"]`);if(s){ot(s,e);let o=this.insIDsByPtr.get(t.ptr);this.graphContainer.querySelectorAll(`.ig-use[data-ig-use="${o}"]`).forEach(n=>{ot(n,e)})}}}updateHotness(){this.graphContainer.querySelectorAll(".ig-ins-lir").forEach(t=>{w(t.classList.contains("ig-hotness"));let e=parseInt(I(t.getAttribute("data-ig-ins-id")),10),s=0;this.sampleCounts&&(s=((this.heatmapMode===E?this.sampleCounts.totalLineHits:this.sampleCounts.selfLineHits).get(e)??0)/this.maxSampleCounts[this.heatmapMode]),t.style.setProperty("--ig-hotness",`${s}`)})}addEventListeners(){this.viewport.addEventListener("wheel",e=>{e.preventDefault();let s=this.zoom;if(e.ctrlKey){s=Math.max(Mt,Math.min(Nt,this.zoom*Math.pow(St,-e.deltaY*Ct)));let n=s/this.zoom-1;this.zoom=s;let{x:r,y:i}=this.viewport.getBoundingClientRect(),l=e.clientX-r-this.translation.x,c=e.clientY-i-this.translation.y;this.translation.x-=l*n,this.translation.y-=c*n}else this.translation.x-=e.deltaX,this.translation.y-=e.deltaY;let o=this.clampTranslation(this.translation,s);this.translation.x=o.x,this.translation.y=o.y,this.animating=!1,this.updatePanAndZoom()}),this.viewport.addEventListener("pointerdown",e=>{e.pointerType==="mouse"&&!(e.button===0||e.button===1)||(e.preventDefault(),this.viewport.setPointerCapture(e.pointerId),this.startMousePos={x:e.clientX,y:e.clientY},this.lastMousePos={x:e.clientX,y:e.clientY},this.animating=!1)}),this.viewport.addEventListener("pointermove",e=>{if(!this.viewport.hasPointerCapture(e.pointerId))return;let s=e.clientX-this.lastMousePos.x,o=e.clientY-this.lastMousePos.y;this.translation.x+=s,this.translation.y+=o,this.lastMousePos={x:e.clientX,y:e.clientY};let n=this.clampTranslation(this.translation,this.zoom);this.translation.x=n.x,this.translation.y=n.y,this.animating=!1,this.updatePanAndZoom()}),this.viewport.addEventListener("pointerup",e=>{this.viewport.releasePointerCapture(e.pointerId);let s=2,o=this.startMousePos.x-e.clientX,n=this.startMousePos.y-e.clientY;Math.abs(o)<=s&&Math.abs(n)<=s&&this.setSelection([]),this.animating=!1}),new ResizeObserver(e=>{w(e.length===1);let s=e[0].contentRect;this.viewportSize.x=s.width,this.viewportSize.y=s.height}).observe(this.viewport)}setSelection(t,e=0){this.setSelectionRaw(t,e),e?this.nav={visited:[e],currentIndex:0,siblings:[e]}:this.nav={visited:[],currentIndex:-1,siblings:[]}}setSelectionRaw(t,e){this.selectedBlockPtrs.clear();for(let s of[...t,e])this.blocksByPtr.has(s)&&this.selectedBlockPtrs.add(s);this.lastSelectedBlockPtr=this.blocksByPtr.has(e)?e:0,this.renderSelection()}navigate(t){let e=this.lastSelectedBlockPtr;if(t==="down"||t==="up")if(e){let s=I(this.blocksByPtr.get(e)),o=(t==="down"?s.succs:s.preds).map(r=>r.ptr);s.ptr!==this.nav.visited[this.nav.currentIndex]&&(this.nav.visited=[s.ptr],this.nav.currentIndex=0);let n=this.nav.currentIndex+(t==="down"?1:-1);if(0<=n&&n<this.nav.visited.length)this.nav.currentIndex=n,this.nav.siblings=o;else{let r=o[0];r!==void 0&&(t==="down"?(this.nav.visited.push(r),this.nav.currentIndex+=1,w(this.nav.currentIndex===this.nav.visited.length-1)):(this.nav.visited.unshift(r),w(this.nav.currentIndex===0)),this.nav.siblings=o)}this.setSelectionRaw([],this.nav.visited[this.nav.currentIndex])}else{let s=[...this.blocks].sort((l,c)=>l.id-c.id),o=s.filter(l=>l.preds.length===0),n=s.filter(l=>l.succs.length===0),r=t==="down"?o:n,i=r[0];w(i),this.setSelectionRaw([],i.ptr),this.nav={visited:[i.ptr],currentIndex:0,siblings:r.map(l=>l.ptr)}}else if(e!==void 0){let s=this.nav.siblings.indexOf(e);w(s>=0,"currently selected node should be in siblings array");let o=s+(t==="right"?1:-1);0<=o&&o<this.nav.siblings.length&&this.setSelectionRaw([],this.nav.siblings[o])}w(this.nav.visited.length===0||this.nav.siblings.includes(this.nav.visited[this.nav.currentIndex]),"expected currently visited node to be in the siblings array"),w(this.lastSelectedBlockPtr===0||this.nav.siblings.includes(this.lastSelectedBlockPtr),"expected currently selected block to be in siblings array")}toggleInstructionHighlight(t,e){this.removeNonexistentHighlights();let s=this.highlightedInstructions.findIndex(n=>n.ptr===t),o=s>=0;if(e!==void 0&&(o=!e),o)s>=0&&this.highlightedInstructions.splice(s,1);else if(s<0){let n=0;for(;;){if(this.highlightedInstructions.find(r=>r.paletteColor===n)){n+=1;continue}break}this.highlightedInstructions.push({ptr:t,paletteColor:n})}this.updateHighlightedInstructions()}clampTranslation(t,e){let s=R-this.size.x*e,o=this.viewportSize.x-R,n=R-this.size.y*e,r=this.viewportSize.y-R,i=V(t.x,s,o),l=V(t.y,n,r);return{x:i,y:l}}updatePanAndZoom(){let t=this.clampTranslation(this.translation,this.zoom);this.graphContainer.style.transform=`translate(${t.x}px, ${t.y}px) scale(${this.zoom})`}graph2viewport(t,e=this.translation,s=this.zoom){return{x:t.x*s+e.x,y:t.y*s+e.y}}viewport2graph(t,e=this.translation,s=this.zoom){return{x:(t.x-e.x)/s,y:(t.y-e.y)/s}}async goToGraphCoordinates(t,{zoom:e=this.zoom,animate:s=!0}){let o={x:-t.x*e,y:-t.y*e};if(!s){this.animating=!1,this.translation.x=o.x,this.translation.y=o.y,this.zoom=e,this.updatePanAndZoom(),await new Promise(r=>setTimeout(r,0));return}if(this.targetTranslation=o,this.targetZoom=e,this.animating)return;this.animating=!0;let n=performance.now();for(;this.animating;){let r=await new Promise(m=>requestAnimationFrame(m)),i=(r-n)/1e3;n=r;let l=1,c=.01,h=1e-6,d=this.targetTranslation.x-this.translation.x,u=this.targetTranslation.y-this.translation.y,p=this.targetZoom-this.zoom;if(this.translation.x=A(this.translation.x,this.targetTranslation.x,h,i),this.translation.y=A(this.translation.y,this.targetTranslation.y,h,i),this.zoom=A(this.zoom,this.targetZoom,h,i),this.updatePanAndZoom(),Math.abs(d)<=l&&Math.abs(u)<=l&&Math.abs(p)<=c){this.translation.x=this.targetTranslation.x,this.translation.y=this.targetTranslation.y,this.zoom=this.targetZoom,this.animating=!1,this.updatePanAndZoom();break}}await new Promise(r=>setTimeout(r,0))}jumpToBlock(t,{zoom:e=this.zoom,animate:s=!0,viewportPos:o}={}){let n=this.blocksByPtr.get(t);if(!n)return Promise.resolve();if(!n.layoutNode)return this.deferredJumpToBlock={blockPtr:t,opts:{zoom:e,animate:s,viewportPos:o}},Promise.resolve();let r;return o?r={x:n.layoutNode.pos.x-o.x/e,y:n.layoutNode.pos.y-o.y/e}:r=this.graphPosToCenterRect(n.layoutNode.pos,n.layoutNode.size,e),this.goToGraphCoordinates(r,{zoom:e,animate:s})}async jumpToInstruction(t,{zoom:e=this.zoom,animate:s=!0}){let o=this.graphContainer.querySelector(`.ig-ins[data-ig-ins-id="${t}"]`);if(!o)return;let n=o.getBoundingClientRect(),r=this.graphContainer.getBoundingClientRect(),i=(n.x-r.x)/this.zoom,l=(n.y-r.y)/this.zoom,c=n.width/this.zoom,h=n.height/this.zoom,d=this.graphPosToCenterRect({x:i,y:l},{x:c,y:h},e);o.classList.add("ig-flash"),await this.goToGraphCoordinates(d,{zoom:e,animate:s}),o.classList.remove("ig-flash")}graphPosToCenterRect(t,e,s){let o=this.viewportSize.x/s,n=this.viewportSize.y/s,r=Math.max(20/s,(o-e.x)/2),i=Math.max(20/s,(n-e.y)/2),l=t.x-r,c=t.y-i;return{x:l,y:c}}exportState(){let t={translation:this.translation,zoom:this.zoom,heatmapMode:this.heatmapMode,highlightedInstructions:this.highlightedInstructions,selectedBlockPtrs:this.selectedBlockPtrs,lastSelectedBlockPtr:this.lastSelectedBlockPtr,viewportPosOfSelectedBlock:void 0};return this.lastSelectedBlockPtr&&(t.viewportPosOfSelectedBlock=this.graph2viewport(I(this.blocksByPtr.get(this.lastSelectedBlockPtr)).layoutNode.pos)),t}restoreState(t,e){this.translation.x=t.translation.x,this.translation.y=t.translation.y,this.zoom=t.zoom,this.heatmapMode=t.heatmapMode,this.highlightedInstructions=t.highlightedInstructions,this.setSelection(Array.from(t.selectedBlockPtrs),t.lastSelectedBlockPtr),this.updatePanAndZoom(),this.updateHotness(),this.updateHighlightedInstructions(),e.preserveSelectedBlockPosition&&this.jumpToBlock(this.lastSelectedBlockPtr,{zoom:this.zoom,animate:!1,viewportPos:t.viewportPosOfSelectedBlock})}};function*Z(a){for(let t of a)for(let e of t)e.block===null&&(yield e)}function Et(a,t,e,s,o,n,r=1){let i=$;r%2===1&&(a+=.5,e+=.5,o+=.5);let l="";if(l+=`M ${a} ${t} `,Math.abs(e-a)<2*i)l+=`C ${a} ${t+(s-t)/3} ${e} ${t+2*(s-t)/3} ${e} ${s} `;else{let d=Math.sign(e-a);l+=`L ${a} ${o-i} `,l+=`A ${i} ${i} 0 0 ${d>0?0:1} ${a+i*d} ${o} `,l+=`L ${e-i*d} ${o} `,l+=`A ${i} ${i} 0 0 ${d>0?1:0} ${e} ${o+i} `,l+=`L ${e} ${s} `}let c=document.createElementNS("http://www.w3.org/2000/svg","g"),h=document.createElementNS("http://www.w3.org/2000/svg","path");if(h.setAttribute("d",l),h.setAttribute("fill","none"),h.setAttribute("stroke","black"),h.setAttribute("stroke-width",`${r} `),c.appendChild(h),n){let d=X(e,s,180);c.appendChild(d)}return c}function $t(a,t,e,s,o,n,r=1){let i=$;r%2===1&&(a+=.5,e+=.5,o+=.5);let l="";if(l+=`M ${a} ${t} `,Math.abs(e-a)<2*i)l+=`C ${a} ${t+(s-t)/3} ${e} ${t+2*(s-t)/3} ${e} ${s} `;else{let d=Math.sign(e-a);l+=`L ${a} ${o+i} `,l+=`A ${i} ${i} 0 0 ${d>0?1:0} ${a+i*d} ${o} `,l+=`L ${e-i*d} ${o} `,l+=`A ${i} ${i} 0 0 ${d>0?0:1} ${e} ${o-i} `,l+=`L ${e} ${s} `}let c=document.createElementNS("http://www.w3.org/2000/svg","g"),h=document.createElementNS("http://www.w3.org/2000/svg","path");if(h.setAttribute("d",l),h.setAttribute("fill","none"),h.setAttribute("stroke","black"),h.setAttribute("stroke-width",`${r} `),c.appendChild(h),n){let d=X(e,s,0);c.appendChild(d)}return c}function Ht(a,t,e,s,o,n=1){let r=$;n%2===1&&(a+=.5,e+=.5,o+=.5);let i="";i+=`M ${a} ${t} `,i+=`L ${a} ${o-r} `,i+=`A ${r} ${r} 0 0 0 ${a+r} ${o} `,i+=`L ${e-r} ${o} `,i+=`A ${r} ${r} 0 0 0 ${e} ${o-r} `,i+=`L ${e} ${s} `;let l=document.createElementNS("http://www.w3.org/2000/svg","g"),c=document.createElementNS("http://www.w3.org/2000/svg","path");return c.setAttribute("d",i),c.setAttribute("fill","none"),c.setAttribute("stroke","black"),c.setAttribute("stroke-width",`${n} `),l.appendChild(c),l}function At(a,t,e,s,o,n=1){let r=$;n%2===1&&(a+=.5,e+=.5,t+=.5,s+=.5,o+=.5);let i="";i+=`M ${a} ${t} `,i+=`L ${a} ${o+r} `,i+=`A ${r} ${r} 0 0 0 ${a-r} ${o} `,i+=`L ${e+r} ${o} `,i+=`A ${r} ${r} 0 0 0 ${e} ${o+r} `,i+=`L ${e} ${s} `;let l=document.createElementNS("http://www.w3.org/2000/svg","g"),c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",i),c.setAttribute("fill","none"),c.setAttribute("stroke","black"),c.setAttribute("stroke-width",`${n} `),l.appendChild(c);let h=X(e,s,180);return l.appendChild(h),l}function X(a,t,e,s=5){let o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("d",`M 0 0 L ${-s} ${s*1.5} L ${s} ${s*1.5} Z`),o.setAttribute("transform",`translate(${a}, ${t}) rotate(${e})`),o}function ot(a,t){a.classList.add("ig-highlight"),a.style.setProperty("--ig-highlight-color",t)}function Ot(a){a.classList.remove("ig-highlight"),a.style.setProperty("--ig-highlight-color","transparent")}var H=class{constructor(t,{func:e,pass:s=0,sampleCounts:o}){this.graph=null,this.func=e,this.passNumber=s,this.sampleCounts=o,this.keyPasses=[null,null,null,null];{let n=null;for(let[r,i]of e.passes.entries())i.mir.blocks.length>0&&(this.keyPasses[0]===null&&(this.keyPasses[0]=r),i.lir.blocks.length===0&&(this.keyPasses[1]=r)),i.lir.blocks.length>0&&(n?.lir.blocks.length===0&&(this.keyPasses[2]=r),this.keyPasses[3]=r),n=i}this.redundantPasses=[];{let n=null;for(let[r,i]of e.passes.entries()){if(n===null){n=i;continue}C(n.mir,i.mir)&&C(n.lir,i.lir)&&this.redundantPasses.push(r),n=i}}this.viewport=b("div",["ig-flex-grow-1","ig-overflow-hidden"],n=>{n.style.position="relative"}),this.sidebarLinks=e.passes.map((n,r)=>b("a",["ig-link-normal","ig-pv1","ig-ph2","ig-flex","ig-g2"],i=>{i.href="#",i.addEventListener("click",l=>{l.preventDefault(),this.switchPass(r)}),i.style.minWidth="100%"},[b("div",["ig-w1","ig-tr","ig-f6","ig-text-dim"],i=>{i.style.paddingTop="0.08rem",i.style.flexShrink="0"},[`${r}`]),b("div",[this.redundantPasses.includes(r)&&"ig-text-dim"],i=>{i.style.whiteSpace="nowrap"},[n.name])])),this.container=b("div",["ig-absolute","ig-absolute-fill","ig-flex"],()=>{},[b("div",["ig-w5","ig-br","ig-flex-shrink-0","ig-overflow-y-auto","ig-bg-white"],n=>{n.style.overflowX="auto"},[...this.sidebarLinks]),this.viewport]),t.appendChild(this.container),this.keydownHandler=this.keydownHandler.bind(this),this.tweakHandler=this.tweakHandler.bind(this),window.addEventListener("keydown",this.keydownHandler),window.addEventListener("tweak",this.tweakHandler),this.update()}destroy(){this.container.remove(),window.removeEventListener("keydown",this.keydownHandler),window.removeEventListener("tweak",this.tweakHandler)}update(){for(let[s,o]of this.sidebarLinks.entries())o.classList.toggle("ig-bg-primary",this.passNumber===s);let t=this.graph?.exportState();this.viewport.innerHTML="",this.graph=null;let e=this.func.passes[this.passNumber];if(e)try{this.graph=new F(this.viewport,e,{sampleCounts:this.sampleCounts}),t&&this.graph.restoreState(t,{preserveSelectedBlockPosition:!0})}catch(s){this.viewport.innerHTML="An error occurred while laying out the graph. See console.",console.error(s)}}switchPass(t){this.passNumber=t,this.update()}keydownHandler(t){switch(t.key){case"w":case"s":this.graph?.navigate(t.key==="s"?"down":"up"),this.graph?.jumpToBlock(this.graph.lastSelectedBlockPtr);break;case"a":case"d":this.graph?.navigate(t.key==="d"?"right":"left"),this.graph?.jumpToBlock(this.graph.lastSelectedBlockPtr);break;case"f":for(let e=this.passNumber+1;e<this.func.passes.length;e++)if(!this.redundantPasses.includes(e)){this.switchPass(e);break}break;case"r":for(let e=this.passNumber-1;e>=0;e--)if(!this.redundantPasses.includes(e)){this.switchPass(e);break}break;case"1":case"2":case"3":case"4":{let e=["1","2","3","4"].indexOf(t.key),s=this.keyPasses[e];typeof s=="number"&&this.switchPass(s)}break;case"c":{let e=this.graph?.blocksByPtr.get(this.graph?.lastSelectedBlockPtr??-1);e&&this.graph?.jumpToBlock(e.ptr,{zoom:1})}break}}tweakHandler(){this.update()}};var S=new URL(window.location.toString()).searchParams,Rt=S.has("func")?parseInt(S.get("func"),10):void 0,rt=S.has("pass")?parseInt(S.get("pass"),10):void 0,z=class{constructor(t){this.exportButton=null,this.ionjson=null,this.funcIndex=Rt??0,this.funcSelected=t.funcSelected,this.funcSelector=b("div",[],()=>{},["Function",b("input",["ig-w3"],e=>{e.type="number",e.min="1",e.addEventListener("input",()=>{this.switchFunc(parseInt(e.value,10)-1)})},[])," / ",b("span",["num-functions"])]),this.funcSelectorNone=b("div",[],()=>{},["No functions to display."]),this.funcName=b("div"),this.root=b("div",["ig-bb","ig-flex","ig-bg-white"],()=>{},[b("div",["ig-pv2","ig-ph3","ig-flex","ig-g2","ig-items-center","ig-br","ig-hide-if-empty"],()=>{},[t.browse&&b("div",[],()=>{},[b("input",[],e=>{e.type="file",e.addEventListener("change",s=>{let o=s.target;o.files?.length&&this.fileSelected(o.files[0])})})]),this.funcSelector,this.funcSelectorNone]),b("div",["ig-flex-grow-1","ig-pv2","ig-ph3","ig-flex","ig-g2","ig-items-center"],()=>{},[this.funcName,b("div",["ig-flex-grow-1"]),t.export&&b("div",[],()=>{},[b("button",[],e=>{this.exportButton=e,e.addEventListener("click",()=>{this.exportStandalone()})},["Export"])])])]),this.update()}async fileSelected(t){let e=JSON.parse(await t.text());this.ionjson=j(e),this.switchFunc(0),this.update()}switchIonJSON(t){this.ionjson=t,this.switchFunc(this.funcIndex)}switchFunc(t){t=Math.max(0,Math.min(this.numFunctions()-1,t)),this.funcIndex=isNaN(t)?0:t,this.funcSelected(this.ionjson?.functions[this.funcIndex]??null),this.update()}numFunctions(){return this.ionjson?.functions.length??0}update(){let t=0<=this.funcIndex&&this.funcIndex<this.numFunctions();this.funcSelector.hidden=this.numFunctions()<=1,this.funcSelectorNone.hidden=!(this.ionjson&&this.numFunctions()===0);let e=this.funcSelector.querySelector("input");e.max=`${this.numFunctions()}`,e.value=`${this.funcIndex+1}`,this.funcSelector.querySelector(".num-functions").innerHTML=`${this.numFunctions()}`,this.funcName.hidden=!t,this.funcName.innerText=`${this.ionjson?.functions[this.funcIndex].name??""}`,this.exportButton&&(this.exportButton.disabled=!this.ionjson||!t)}async exportStandalone(){let t=I(this.ionjson),e=t.functions[this.funcIndex].name,s={version:1,functions:[t.functions[this.funcIndex]]},n=(window.__standaloneTemplate??await(await fetch("./standalone.html")).text()).replace(/\{\{\s*IONJSON\s*\}\}/,JSON.stringify(s)),r=URL.createObjectURL(new Blob([n],{type:"text/html;charset=utf-8"})),i=document.createElement("a");i.href=r,i.download=`iongraph-${e}.html`,document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(r)}},U=class{constructor(){this.menuBar=new z({browse:!0,export:!0,funcSelected:t=>this.switchFunc(t)}),this.func=null,this.sampleCountsFromFile=void 0,this.graph=null,this.loadStuffFromQueryParams(),this.graphContainer=b("div",["ig-relative","ig-flex-basis-0","ig-flex-grow-1","ig-overflow-hidden"]),this.root=b("div",["ig-absolute","ig-absolute-fill","ig-flex","ig-flex-column"],t=>{t.addEventListener("dragenter",e=>{e.preventDefault(),e.stopPropagation()}),t.addEventListener("dragover",e=>{e.preventDefault(),e.stopPropagation()}),t.addEventListener("drop",e=>{e.preventDefault(),e.stopPropagation();let s=e.dataTransfer?.files;s&&s.length>0&&this.menuBar.fileSelected(s[0])})},[this.menuBar.root,this.graphContainer]),this.update()}update(){this.graph&&this.graph.destroy(),this.func&&(this.graph=new H(this.graphContainer,{func:this.func,pass:rt,sampleCounts:this.sampleCountsFromFile}))}loadStuffFromQueryParams(){(async()=>{let t=S.get("file");if(t){let s=await(await fetch(t)).json(),o=j(s);this.menuBar.switchIonJSON(o)}})(),(async()=>{let t=S.get("sampleCounts");if(t){let s=await(await fetch(t)).json();this.sampleCountsFromFile={selfLineHits:new Map(s.selfLineHits),totalLineHits:new Map(s.totalLineHits)},this.update()}})()}switchFunc(t){this.func=t,this.update()}},q=class{constructor(){this.menuBar=new z({funcSelected:t=>this.switchFunc(t)}),this.func=null,this.graph=null,this.graphContainer=b("div",["ig-relative","ig-flex-basis-0","ig-flex-grow-1","ig-overflow-hidden"]),this.root=b("div",["ig-absolute","ig-absolute-fill","ig-flex","ig-flex-column"],()=>{},[this.menuBar.root,this.graphContainer])}update(){this.graph&&this.graph.destroy(),this.func&&(this.graph=new H(this.graphContainer,{func:this.func,pass:rt}))}setIonJSON(t){this.menuBar.switchIonJSON(t)}switchFunc(t){this.func=t,this.update()}};return mt(Dt);})();
</script>
  <script>
    window.__standaloneTemplate = atob("PCFET0NUWVBFIGh0bWw+Cgo8aGVhZD4KICA8dGl0bGU+aW9uZ3JhcGg8L3RpdGxlPgogIDxzdHlsZT4vKiBpb25ncmFwaC1zcGVjaWZpYyBzdHlsZXMgaW5zcGlyZWQgYnkgVGFjaHlvbnMgKi8KCjpyb290IHsKICAtLWlnLXNpemUtMTogMXJlbTsKICAtLWlnLXNpemUtMjogMnJlbTsKICAtLWlnLXNpemUtMzogNHJlbTsKICAtLWlnLXNpemUtNDogOHJlbTsKICAtLWlnLXNpemUtNTogMTZyZW07CgogIC0taWctc3BhY2luZy0xOiAuMjVyZW07CiAgLS1pZy1zcGFjaW5nLTI6IC41cmVtOwogIC0taWctc3BhY2luZy0zOiAxcmVtOwogIC0taWctc3BhY2luZy00OiAycmVtOwogIC0taWctc3BhY2luZy01OiA0cmVtOwogIC0taWctc3BhY2luZy02OiA4cmVtOwogIC0taWctc3BhY2luZy03OiAxNnJlbTsKCiAgLS1pZy10ZXh0LWNvbG9yOiBibGFjazsKICAtLWlnLXRleHQtY29sb3ItZGltOiAjNzc3OwogIC0taWctYmFja2dyb3VuZC1wcmltYXJ5OiAjZmZiNTRlOwogIC0taWctYmFja2dyb3VuZC1saWdodDogd2hpdGU7CiAgLS1pZy1ib3JkZXItY29sb3I6ICMwYzBjMGQ7CgogIC0taWctYmxvY2staGVhZGVyLWNvbG9yOiAjMGMwYzBkOwogIC0taWctbG9vcC1oZWFkZXItY29sb3I6ICMxZmE0MTE7CiAgLS1pZy1yb290LWJsb2NrLWNvbG9yOiAjMTA0OGFmOwogIC0taWctbW92YWJsZS1jb2xvcjogIzEwNDhhZjsKICAtLWlnLXJvYi1jb2xvcjogIzQ0NDsKICAtLWlnLWluLXdvcmtsaXN0LWNvbG9yOiByZWQ7CgogIC0taWctYmxvY2stc2VsZWN0ZWQ6ICNmZmM4NjM7CiAgLS1pZy1ibG9jay1sYXN0LXNlbGVjdGVkOiAjZmZiNTRlOwoKICAtLWlnLWhpZ2hsaWdodC0wOiAjZmZiNTRlOwogIC0taWctaGlnaGxpZ2h0LTE6ICNmZmI1YzU7CiAgLS1pZy1oaWdobGlnaHQtMjogI2E0Y2JmZjsKICAtLWlnLWhpZ2hsaWdodC0zOiAjOGJlMTgyOwogIC0taWctaGlnaGxpZ2h0LTQ6ICNkOWE0ZmQ7CgogIC0taWctZmxhc2gtY29sb3I6ICNmZmI1NGU7CgogIC8qCiAgICogVGhlIGhlYXRtYXAgb2Ygc2FtcGxlIGNvdW50cyB3aWxsIGVmZmVjdGl2ZWx5IGJlIHNhbXBsZWQgZnJvbSBhIGdyYWRpZW50OgogICAqCiAgICogfC0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfAogICAqIGNvbGQgICAgICJjb29sIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3QKICAgKgogICAqIFRoZSAiY29sZCIgY29sb3Igd2lsbCBzaW1wbHkgYmUgdHJhbnNwYXJlbnQuIFRoZXJlZm9yZSwgdGhlICJjb29sIgogICAqIHRocmVzaG9sZCBpbmRpY2F0ZXMgd2hlcmUgdGhlIGluc3RydWN0aW9uIHdpbGwgYmUgZnVsbHkgY29sb3JlZCBhbmQKICAgKiBub3RpY2VhYmxlIHRvIHRoZSB1c2VyLgogICAqLwogIC0taWctaG90LWNvbG9yOiAjZmY4NDllOwogIC0taWctY29vbC1jb2xvcjogI2ZmZTU0NjsKICAtLWlnLWNvb2wtdGhyZXNob2xkOiAwLjI7Cn0KCmEuaWctbGluay1ub3JtYWwgewogIGNvbG9yOiBpbmhlcml0OwogIHRleHQtZGVjb3JhdGlvbjogaW5oZXJpdDsKfQoKLmlnLWZsZXggewogIGRpc3BsYXk6IGZsZXg7Cn0KCi5pZy1mbGV4LWNvbHVtbiB7CiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKfQoKLmlnLWZsZXgtYmFzaXMtMCB7CiAgZmxleC1iYXNpczogMDsKfQoKLmlnLWZsZXgtZ3Jvdy0xIHsKICBmbGV4LWdyb3c6IDE7Cn0KCi5pZy1mbGV4LXNocmluay0wIHsKICBmbGV4LXNocmluazogMDsKfQoKLmlnLWZsZXgtc2hyaW5rLTEgewogIGZsZXgtc2hyaW5rOiAxOwp9CgouaWctaXRlbXMtY2VudGVyIHsKICBhbGlnbi1pdGVtczogY2VudGVyOwp9CgouaWctcmVsYXRpdmUgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKfQoKLmlnLWFic29sdXRlIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7Cn0KCi5pZy1hYnNvbHV0ZS1maWxsIHsKICB0b3A6IDA7CiAgcmlnaHQ6IDA7CiAgYm90dG9tOiAwOwogIGxlZnQ6IDA7Cn0KCi5pZy1nMSB7CiAgZ2FwOiB2YXIoLS1pZy1zcGFjaW5nLTEpOwp9CgouaWctZzIgewogIGdhcDogdmFyKC0taWctc3BhY2luZy0yKTsKfQoKLmlnLWczIHsKICBnYXA6IHZhcigtLWlnLXNwYWNpbmctMyk7Cn0KCi5pZy13MSB7CiAgd2lkdGg6IHZhcigtLWlnLXNpemUtMSk7Cn0KCi5pZy13MiB7CiAgd2lkdGg6IHZhcigtLWlnLXNpemUtMik7Cn0KCi5pZy13MyB7CiAgd2lkdGg6IHZhcigtLWlnLXNpemUtMyk7Cn0KCi5pZy13NCB7CiAgd2lkdGg6IHZhcigtLWlnLXNpemUtNCk7Cn0KCi5pZy13NSB7CiAgd2lkdGg6IHZhcigtLWlnLXNpemUtNSk7Cn0KCi5pZy13LTEwMCB7CiAgd2lkdGg6IDEwMCU7Cn0KCi5pZy1iYSB7CiAgYm9yZGVyLXN0eWxlOiBzb2xpZDsKICBib3JkZXItd2lkdGg6IDFweDsKICBib3JkZXItY29sb3I6IHZhcigtLWlnLWJvcmRlci1jb2xvcik7Cn0KCi5pZy1idCB7CiAgYm9yZGVyLXRvcC1zdHlsZTogc29saWQ7CiAgYm9yZGVyLXRvcC13aWR0aDogMXB4OwogIGJvcmRlci1jb2xvcjogdmFyKC0taWctYm9yZGVyLWNvbG9yKTsKfQoKLmlnLWJyIHsKICBib3JkZXItcmlnaHQtc3R5bGU6IHNvbGlkOwogIGJvcmRlci1yaWdodC13aWR0aDogMXB4OwogIGJvcmRlci1jb2xvcjogdmFyKC0taWctYm9yZGVyLWNvbG9yKTsKfQoKLmlnLWJiIHsKICBib3JkZXItYm90dG9tLXN0eWxlOiBzb2xpZDsKICBib3JkZXItYm90dG9tLXdpZHRoOiAxcHg7CiAgYm9yZGVyLWNvbG9yOiB2YXIoLS1pZy1ib3JkZXItY29sb3IpOwp9CgouaWctYmwgewogIGJvcmRlci1sZWZ0LXN0eWxlOiBzb2xpZDsKICBib3JkZXItbGVmdC13aWR0aDogMXB4OwogIGJvcmRlci1jb2xvcjogdmFyKC0taWctYm9yZGVyLWNvbG9yKTsKfQoKLmlnLXBhMSB7CiAgcGFkZGluZzogdmFyKC0taWctc3BhY2luZy0xKTsKfQoKLmlnLXBhMiB7CiAgcGFkZGluZzogdmFyKC0taWctc3BhY2luZy0yKTsKfQoKLmlnLXBhMyB7CiAgcGFkZGluZzogdmFyKC0taWctc3BhY2luZy0zKTsKfQoKLmlnLXBoMSB7CiAgcGFkZGluZy1sZWZ0OiB2YXIoLS1pZy1zcGFjaW5nLTEpOwogIHBhZGRpbmctcmlnaHQ6IHZhcigtLWlnLXNwYWNpbmctMSk7Cn0KCi5pZy1waDIgewogIHBhZGRpbmctbGVmdDogdmFyKC0taWctc3BhY2luZy0yKTsKICBwYWRkaW5nLXJpZ2h0OiB2YXIoLS1pZy1zcGFjaW5nLTIpOwp9CgouaWctcGgzIHsKICBwYWRkaW5nLWxlZnQ6IHZhcigtLWlnLXNwYWNpbmctMyk7CiAgcGFkZGluZy1yaWdodDogdmFyKC0taWctc3BhY2luZy0zKTsKfQoKLmlnLXB2MSB7CiAgcGFkZGluZy10b3A6IHZhcigtLWlnLXNwYWNpbmctMSk7CiAgcGFkZGluZy1ib3R0b206IHZhcigtLWlnLXNwYWNpbmctMSk7Cn0KCi5pZy1wdjIgewogIHBhZGRpbmctdG9wOiB2YXIoLS1pZy1zcGFjaW5nLTIpOwogIHBhZGRpbmctYm90dG9tOiB2YXIoLS1pZy1zcGFjaW5nLTIpOwp9CgouaWctcHYzIHsKICBwYWRkaW5nLXRvcDogdmFyKC0taWctc3BhY2luZy0zKTsKICBwYWRkaW5nLWJvdHRvbTogdmFyKC0taWctc3BhY2luZy0zKTsKfQoKLmlnLXB0MSB7CiAgcGFkZGluZy10b3A6IHZhcigtLWlnLXNwYWNpbmctMSk7Cn0KCi5pZy1wdDIgewogIHBhZGRpbmctdG9wOiB2YXIoLS1pZy1zcGFjaW5nLTIpOwp9CgouaWctcHQzIHsKICBwYWRkaW5nLXRvcDogdmFyKC0taWctc3BhY2luZy0zKTsKfQoKLmlnLXByMSB7CiAgcGFkZGluZy1yaWdodDogdmFyKC0taWctc3BhY2luZy0xKTsKfQoKLmlnLXByMiB7CiAgcGFkZGluZy1yaWdodDogdmFyKC0taWctc3BhY2luZy0yKTsKfQoKLmlnLXByMyB7CiAgcGFkZGluZy1yaWdodDogdmFyKC0taWctc3BhY2luZy0zKTsKfQoKLmlnLXBiMSB7CiAgcGFkZGluZy1ib3R0b206IHZhcigtLWlnLXNwYWNpbmctMSk7Cn0KCi5pZy1wYjIgewogIHBhZGRpbmctYm90dG9tOiB2YXIoLS1pZy1zcGFjaW5nLTIpOwp9CgouaWctcGIzIHsKICBwYWRkaW5nLWJvdHRvbTogdmFyKC0taWctc3BhY2luZy0zKTsKfQoKLmlnLXBsMSB7CiAgcGFkZGluZy1sZWZ0OiB2YXIoLS1pZy1zcGFjaW5nLTEpOwp9CgouaWctcGwyIHsKICBwYWRkaW5nLWxlZnQ6IHZhcigtLWlnLXNwYWNpbmctMik7Cn0KCi5pZy1wbDMgewogIHBhZGRpbmctbGVmdDogdmFyKC0taWctc3BhY2luZy0zKTsKfQoKLmlnLWYxIHsKICBmb250LXNpemU6IDNyZW07Cn0KCi5pZy1mMiB7CiAgZm9udC1zaXplOiAyLjI1cmVtOwp9CgouaWctZjMgewogIGZvbnQtc2l6ZTogMS41cmVtOwp9CgouaWctZjQgewogIGZvbnQtc2l6ZTogMS4yNXJlbTsKfQoKLmlnLWY1IHsKICBmb250LXNpemU6IDFyZW07Cn0KCi5pZy1mNiB7CiAgZm9udC1zaXplOiAuODc1cmVtOwp9CgouaWctZjcgewogIGZvbnQtc2l6ZTogLjc1cmVtOwp9CgouaWctdGV4dC1ub3JtYWwgewogIGNvbG9yOiB2YXIoLS1pZy10ZXh0LWNvbG9yKTsKfQoKLmlnLXRleHQtZGltIHsKICBjb2xvcjogdmFyKC0taWctdGV4dC1jb2xvci1kaW0pOwp9CgouaWctdGwgewogIHRleHQtYWxpZ246IGxlZnQ7Cn0KCi5pZy10ciB7CiAgdGV4dC1hbGlnbjogcmlnaHQ7Cn0KCi5pZy10YyB7CiAgdGV4dC1hbGlnbjogY2VudGVyOwp9CgouaWctYmctd2hpdGUgewogIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWlnLWJhY2tncm91bmQtbGlnaHQpOwp9CgouaWctYmctcHJpbWFyeSB7CiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0taWctYmFja2dyb3VuZC1wcmltYXJ5KTsKfQoKLmlnLW92ZXJmbG93LWhpZGRlbiB7CiAgb3ZlcmZsb3c6IGhpZGRlbjsKfQoKLmlnLW92ZXJmbG93LWF1dG8gewogIG92ZXJmbG93OiBhdXRvOwp9CgouaWctb3ZlcmZsb3cteC1hdXRvIHsKICBvdmVyZmxvdy14OiBhdXRvOwp9CgouaWctb3ZlcmZsb3cteS1hdXRvIHsKICBvdmVyZmxvdy15OiBhdXRvOwp9CgouaWctaGlkZS1pZi1lbXB0eTplbXB0eSB7CiAgZGlzcGxheTogbm9uZTsKfQoKLyogTm9uLXV0aWxpdHkgc3R5bGVzICovCgouaWctZ3JhcGggewogIGNvbG9yOiB2YXIoLS1pZy10ZXh0LWNvbG9yKTsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgbGVmdDogMDsKICB0b3A6IDA7CiAgaXNvbGF0aW9uOiBpc29sYXRlOwp9CgouaWctYmxvY2sgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKCiAgLmlnLWJsb2NrLWhlYWRlciB7CiAgICBmb250LXdlaWdodDogYm9sZDsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWlnLWJsb2NrLWhlYWRlci1jb2xvcik7CiAgICBjb2xvcjogd2hpdGU7CiAgICBwYWRkaW5nOiAwIDFlbTsKICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWlnLWJvcmRlci1jb2xvcik7CiAgICBib3JkZXItd2lkdGg6IDFweCAxcHggMDsKICB9CgogIC5pZy1pbnN0cnVjdGlvbnMgewogICAgcGFkZGluZzogMC41ZW07CiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1pZy1ib3JkZXItY29sb3IpOwogICAgYm9yZGVyLXdpZHRoOiAwIDFweCAxcHg7CgogICAgdGFibGUgewogICAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOwogICAgfQoKICAgIHRkLAogICAgdGggewogICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgICBwYWRkaW5nOiAwLjFlbSAwLjVlbTsKICAgIH0KCiAgICB0aCB7CiAgICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7CiAgICB9CiAgfQoKICAmLmlnLXNlbGVjdGVkIHsKICAgIG91dGxpbmU6IDRweCBzb2xpZCB2YXIoLS1pZy1ibG9jay1zZWxlY3RlZCk7CiAgfQoKICAmLmlnLWxhc3Qtc2VsZWN0ZWQgewogICAgb3V0bGluZS1jb2xvcjogdmFyKC0taWctYmxvY2stbGFzdC1zZWxlY3RlZCk7CiAgfQp9CgouaWctYmxvY2stYXR0LWxvb3BoZWFkZXIgewogIC5pZy1ibG9jay1oZWFkZXIgewogICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0taWctbG9vcC1oZWFkZXItY29sb3IpOwogIH0KfQoKLmlnLWJsb2NrLWF0dC1yb290IHsKICAuaWctYmxvY2staGVhZGVyIHsKICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWlnLXJvb3QtYmxvY2stY29sb3IpOwogIH0KfQoKLmlnLWJsb2NrLWF0dC1zcGxpdGVkZ2UgewogIC5pZy1pbnN0cnVjdGlvbnMgewogICAgYm9yZGVyLXN0eWxlOiBkb3R0ZWQ7CiAgICBib3JkZXItd2lkdGg6IDAgMnB4IDJweDsKICB9Cn0KCi5pZy1pbnMtbnVtIHsKICB0ZXh0LWFsaWduOiByaWdodDsKICBjdXJzb3I6IHBvaW50ZXI7Cn0KCi5pZy1pbnMtdHlwZSB7CiAgdGV4dC1hbGlnbjogcmlnaHQ7Cn0KCi5pZy1pbnMtc2FtcGxlcyB7CiAgZm9udC1zaXplOiAwLjg3NWVtOwogIHRleHQtYWxpZ246IHJpZ2h0OwogIGN1cnNvcjogcG9pbnRlcjsKfQoKLmlnLXVzZSB7CiAgcGFkZGluZzogMCAwLjI1ZW07CiAgYm9yZGVyLXJhZGl1czogMnB4OwogIGN1cnNvcjogcG9pbnRlcjsKfQoKLmlnLWVkZ2UtbGFiZWwgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBmb250LXNpemU6IDAuOGVtOwogIGxpbmUtaGVpZ2h0OiAxOwogIGJvdHRvbTogLTFlbTsKICBwYWRkaW5nLWxlZnQ6IDRweDsKfQoKLmlnLWlucy1hdHQtUmVjb3ZlcmVkT25CYWlsb3V0IHsKICBjb2xvcjogdmFyKC0taWctcm9iLWNvbG9yKTsKfQoKLmlnLWlucy1hdHQtTW92YWJsZSB7CiAgY29sb3I6IHZhcigtLWlnLW1vdmFibGUtY29sb3IpOwp9CgouaWctaW5zLWF0dC1HdWFyZCB7CiAgdGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmU7Cn0KCi5pZy1pbnMtYXR0LUluV29ya2xpc3QgewogIGNvbG9yOiB2YXIoLS1pZy1pbi13b3JrbGlzdC1jb2xvcik7Cn0KCi5pZy1jYW4tZmxhc2ggewogIHRyYW5zaXRpb246IG91dGxpbmUtY29sb3IgMXMgZWFzZS1vdXQ7CiAgb3V0bGluZTogM3B4IHNvbGlkIGNvbG9yLW1peChpbiBzcmdiLCB2YXIoLS1pZy1mbGFzaC1jb2xvcikgMCUsIHRyYW5zcGFyZW50KTsKfQoKLmlnLWZsYXNoIHsKICB0cmFuc2l0aW9uOiBvdXRsaW5lLWNvbG9yIDBzOwogIG91dGxpbmUtY29sb3I6IHZhcigtLWlnLWZsYXNoLWNvbG9yKTsKfQoKLmlnLWhvdG5lc3MgewogIC0taWctaG90bmVzczogMDsKCiAgLS1pZy1jb2xkLWNvbG9yOiBjb2xvci1taXgoaW4gc3JnYiwgdmFyKC0taWctY29vbC1jb2xvcikgMjAlLCB0cmFuc3BhcmVudCk7CiAgYmFja2dyb3VuZC1jb2xvcjoKICAgIC8qIGNvb2wgPC0+IGhvdCAqLwogICAgY29sb3ItbWl4KGluIG9rbGFiLAogICAgICAvKiBjb2xkIDwtPiBjb29sICovCiAgICAgIGNvbG9yLW1peChpbiBva2xhYiwKICAgICAgICAvKiBkZWFkIG9yIGNvbGQgKi8KICAgICAgICBjb2xvci1taXgoaW4gc3JnYiwgdHJhbnNwYXJlbnQsIHZhcigtLWlnLWNvbGQtY29sb3IpIGNsYW1wKDAlLCBjYWxjKHZhcigtLWlnLWhvdG5lc3MpICogMTAwMDAwMDAwJSksIDEwMCUpKSwKICAgICAgICB2YXIoLS1pZy1jb29sLWNvbG9yKSBjbGFtcCgwJSwgY2FsYygodmFyKC0taWctaG90bmVzcykgLyB2YXIoLS1pZy1jb29sLXRocmVzaG9sZCkpICogMTAwJSksIDEwMCUpKSwKICAgICAgdmFyKC0taWctaG90LWNvbG9yKSBjbGFtcCgwJSwgY2FsYygoKHZhcigtLWlnLWhvdG5lc3MpIC0gdmFyKC0taWctY29vbC10aHJlc2hvbGQpKSAvICgxIC0gdmFyKC0taWctY29vbC10aHJlc2hvbGQpKSkgKiAxMDAlKSwgMTAwJSkpOwp9CgouaWctaGlnaGxpZ2h0IHsKICAtLWlnLWhpZ2hsaWdodC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0taWctaGlnaGxpZ2h0LWNvbG9yKTsKfTwvc3R5bGU+CiAgPHN0eWxlPiogewogIGJveC1zaXppbmc6IGJvcmRlci1ib3g7Cn0KCjpyb290IHsKICBmb250LXNpemU6IDAuODc1cmVtOwp9Cgpib2R5IHsKICBtYXJnaW46IDA7CiAgYmFja2dyb3VuZC1jb2xvcjogI2U1ZThlYTsKICAvKiBGb250LCBhbmQgbWFueSBvdGhlciBzdHlsZXMsIHRha2VuIGZyb20gdGhlIEZpcmVmb3ggUHJvZmlsZXIvICovCiAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgU2Vnb2UgVUksIFJvYm90bywgT3h5Z2VuLVNhbnMsIFVidW50dSwgTm90byBTYW5zLCBMaWJlcmF0aW9uIFNhbnMsIENhbnRhcmVsbCwgSGVsdmV0aWNhIE5ldWUsIHNhbnMtc2VyaWY7Cn0KCiNjb250YWluZXIgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBsZWZ0OiAwOwogIHRvcDogMDsKICByaWdodDogMDsKICBib3R0b206IDA7Cn0KCi50d2Vha3MtcGFuZWwgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBib3R0b206IDA7CiAgcmlnaHQ6IDA7CiAgcGFkZGluZzogMXJlbTsKICBib3JkZXI6IDFweCBzb2xpZCBibGFjazsKICBib3JkZXItd2lkdGg6IDFweCAwIDAgMXB4OwogIGJhY2tncm91bmQtY29sb3I6IHdoaXRlOwp9PC9zdHlsZT4KPC9oZWFkPgoKPGJvZHk+CiAgPHNjcmlwdD4idXNlIHN0cmljdCI7dmFyIGlvbmdyYXBoPSgoKT0+e3ZhciBfPU9iamVjdC5kZWZpbmVQcm9wZXJ0eTt2YXIgY3Q9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjt2YXIgZHQ9T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXM7dmFyIGh0PU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7dmFyIHV0PShhLHQpPT57Zm9yKHZhciBlIGluIHQpXyhhLGUse2dldDp0W2VdLGVudW1lcmFibGU6ITB9KX0scHQ9KGEsdCxlLHMpPT57aWYodCYmdHlwZW9mIHQ9PSJvYmplY3QifHx0eXBlb2YgdD09ImZ1bmN0aW9uIilmb3IobGV0IG8gb2YgZHQodCkpIWh0LmNhbGwoYSxvKSYmbyE9PWUmJl8oYSxvLHtnZXQ6KCk9PnRbb10sZW51bWVyYWJsZTohKHM9Y3QodCxvKSl8fHMuZW51bWVyYWJsZX0pO3JldHVybiBhfTt2YXIgbXQ9YT0+cHQoXyh7fSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksYSk7dmFyIER0PXt9O3V0KER0LHtTdGFuZGFsb25lVUk6KCk9PnEsV2ViVUk6KCk9PlV9KTtmdW5jdGlvbiBqKGEpe2EudmVyc2lvbj09PXZvaWQgMCYmKGEudmVyc2lvbj0wKTtmb3IobGV0IHQgb2YgYS5mdW5jdGlvbnMpZnQodCxhLnZlcnNpb24pO3JldHVybiBhLnZlcnNpb249MSxhfWZ1bmN0aW9uIGZ0KGEsdCl7Zm9yKGxldCBlIG9mIGEucGFzc2VzKXtmb3IobGV0IHMgb2YgZS5taXIuYmxvY2tzKWd0KHMsdCk7Zm9yKGxldCBzIG9mIGUubGlyLmJsb2NrcylrdChzLHQpfXJldHVybiBhfWZ1bmN0aW9uIGd0KGEsdCl7dD09PTAmJihhLnB0cj0oYS5pZD8/YS5udW1iZXIpKzEsYS5pZD1hLm51bWJlcik7Zm9yKGxldCBlIG9mIGEuaW5zdHJ1Y3Rpb25zKWJ0KGUsdCk7cmV0dXJuIGF9ZnVuY3Rpb24gYnQoYSx0KXtyZXR1cm4gdD09PTAmJihhLnB0cj1hLmlkKSxhfWZ1bmN0aW9uIGt0KGEsdCl7dD09PTAmJihhLnB0cj1hLmlkPz9hLm51bWJlcixhLmlkPWEubnVtYmVyKTtmb3IobGV0IGUgb2YgYS5pbnN0cnVjdGlvbnMpeXQoZSx0KTtyZXR1cm4gYX1mdW5jdGlvbiB5dChhLHQpe3JldHVybiB0PT09MCYmKGEucHRyPWEuaWQsYS5taXJQdHI9bnVsbCksYX1mdW5jdGlvbiBWKGEsdCxlKXtyZXR1cm4gTWF0aC5tYXgodCxNYXRoLm1pbihlLGEpKX1mdW5jdGlvbiBBKGEsdCxlLHMpe3JldHVybihhLXQpKk1hdGgucG93KGUscykrdH1mdW5jdGlvbiB3KGEsdCxlPSExKXtpZighYSlpZihlKWNvbnNvbGUuZXJyb3IodD8/IkFzc2VydGlvbiBmYWlsZWQiKTtlbHNlIHRocm93IG5ldyBFcnJvcih0Pz8iQXNzZXJ0aW9uIGZhaWxlZCIpfWZ1bmN0aW9uIEkoYSx0KXtyZXR1cm4gdyhhLHQpLGF9ZnVuY3Rpb24geHQoYSl7cmV0dXJuIHR5cGVvZiBhPT0ic3RyaW5nIj9kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShhKTphfWZ1bmN0aW9uIHd0KGEsdCl7Zm9yKGxldCBlIG9mIHQpZSYmYS5hcHBlbmRDaGlsZCh4dChlKSl9ZnVuY3Rpb24gYihhLHQsZSxzKXtsZXQgbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KGEpO2lmKHQmJnQubGVuZ3RoPjApe2xldCBuPXQuZmlsdGVyKHI9PiEhcik7by5jbGFzc0xpc3QuYWRkKC4uLm4pfXJldHVybiBlPy4obykscyYmd3QobyxzKSxvfXZhciBLPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7ZnVuY3Rpb24gQyhhLHQpe3ZhciBlLHM7aWYoYT09PXQpcmV0dXJuITA7aWYoYSYmdCYmKGU9YS5jb25zdHJ1Y3Rvcik9PT10LmNvbnN0cnVjdG9yKXtpZihlPT09RGF0ZSlyZXR1cm4gYS5nZXRUaW1lKCk9PT10LmdldFRpbWUoKTtpZihlPT09UmVnRXhwKXJldHVybiBhLnRvU3RyaW5nKCk9PT10LnRvU3RyaW5nKCk7aWYoZT09PUFycmF5KXtpZigocz1hLmxlbmd0aCk9PT10Lmxlbmd0aClmb3IoO3MtLSYmQyhhW3NdLHRbc10pOyk7cmV0dXJuIHM9PT0tMX1pZighZXx8dHlwZW9mIGE9PSJvYmplY3QiKXtzPTA7Zm9yKGUgaW4gYSlpZihLLmNhbGwoYSxlKSYmKytzJiYhSy5jYWxsKHQsZSl8fCEoZSBpbiB0KXx8IUMoYVtlXSx0W2VdKSlyZXR1cm4hMTtyZXR1cm4gT2JqZWN0LmtleXModCkubGVuZ3RoPT09c319cmV0dXJuIGEhPT1hJiZ0IT09dH1mdW5jdGlvbiBCKGEsdCxlPXt9KXtsZXQgcz10LG89W10sbj17Z2V0KCl7cmV0dXJuIHN9LHNldChyKXtzPXI7Zm9yKGxldCBpIG9mIG8paShzKX0sdmFsdWVPZigpe3JldHVybiBzfSx0b1N0cmluZygpe3JldHVybiBTdHJpbmcocyl9LFtTeW1ib2wudG9QcmltaXRpdmVdKHIpe3JldHVybiByPT09InN0cmluZyI/U3RyaW5nKHMpOnN9LG9uQ2hhbmdlKHIpe28ucHVzaChyKX0saW5pdGlhbDp0LG5hbWU6YSxtaW46ZS5taW4/PzAsbWF4OmUubWF4Pz8xMDAsc3RlcDplLnN0ZXA/PzF9O3JldHVybihlLnR3ZWFrc09iamVjdD8/RykuYWRkKG4pfXZhciBPPWNsYXNze2NvbnN0cnVjdG9yKHQpe3RoaXMuY29udGFpbmVyPXQuY29udGFpbmVyLHRoaXMudHdlYWtzPVtdLHRoaXMuY2FsbGJhY2tzPVtdfWFkZCh0KXtsZXQgZT10aGlzLnR3ZWFrcy5maW5kKGM9PmMubmFtZT09PXQubmFtZSk7aWYoZSlyZXR1cm4gZTt0aGlzLnR3ZWFrcy5wdXNoKHQpO2xldCBzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO3RoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHMpLHMuc3R5bGUuZGlzcGxheT0iZmxleCIscy5zdHlsZS5hbGlnbkl0ZW1zPSJjZW50ZXIiLHMuc3R5bGUuanVzdGlmeUNvbnRlbnQ9ImVuZCIscy5zdHlsZS5nYXA9IjAuNXJlbSI7bGV0IG89dC5uYW1lLnJlcGxhY2UoL1thLXpBLVowLTldL2csIl8iKSxuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxhYmVsIik7cy5hcHBlbmRDaGlsZChuKSxuLmlubmVyVGV4dD10Lm5hbWUsbi5odG1sRm9yPWB0d2Vhay0ke299LWlucHV0YDtsZXQgcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpO3MuYXBwZW5kQ2hpbGQociksci50eXBlPSJudW1iZXIiLHIudmFsdWU9U3RyaW5nKHQpLHIuaWQ9YHR3ZWFrLSR7b30taW5wdXRgLHIuc3R5bGUud2lkdGg9IjRyZW0iLHIuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCgpPT57dC5zZXQoci52YWx1ZUFzTnVtYmVyKX0pO2xldCBpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7cy5hcHBlbmRDaGlsZChpKSxpLnR5cGU9InJhbmdlIixpLnZhbHVlPVN0cmluZyh0KSxpLm1pbj1TdHJpbmcodC5taW4pLGkubWF4PVN0cmluZyh0Lm1heCksaS5zdGVwPXQuc3RlcD09PTA/ImFueSI6U3RyaW5nKHQuc3RlcCksaS5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsKCk9Pnt0LnNldChpLnZhbHVlQXNOdW1iZXIpfSk7bGV0IGw9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7cmV0dXJuIHMuYXBwZW5kQ2hpbGQobCksbC5pbm5lclRleHQ9IlJlc2V0IixsLmRpc2FibGVkPXQuZ2V0KCk9PT10LmluaXRpYWwsbC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsKCk9Pnt0LnNldCh0LmluaXRpYWwpfSksdC5vbkNoYW5nZShjPT57ci52YWx1ZT1TdHJpbmcoYyksaS52YWx1ZT1TdHJpbmcoYyksbC5kaXNhYmxlZD10LmdldCgpPT09dC5pbml0aWFsO2ZvcihsZXQgaCBvZiB0aGlzLmNhbGxiYWNrcyloKHQpfSksdH1vblR3ZWFrKHQpe3RoaXMuY2FsbGJhY2tzLnB1c2godCl9fSxXPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO1cuY2xhc3NMaXN0LmFkZCgidHdlYWtzLXBhbmVsIik7dmFyIEc9bmV3IE8oe2NvbnRhaW5lcjpXfSk7Ry5vblR3ZWFrKGE9Pnt3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoInR3ZWFrIix7ZGV0YWlsOmF9KSl9KTt3aW5kb3cudHdlYWtzPUc7dmFyIHZ0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLFB0PW5ldyBPKHtjb250YWluZXI6dnR9KSxRPUIoIlRlc3QgVmFsdWUiLDMse3R3ZWFrc09iamVjdDpQdH0pO1Euc2V0KDQpO1E9NDt2YXIgaXQ9QigiRGVidWc/IiwwLHttaW46MCxtYXg6MX0pLEw9MjAsTj00NCx2PTE2LFQ9NjAsJD0xMixNPTM2LHR0PTE2O3ZhciBMdD00MCxJdD1CKCJMYXlvdXQgSXRlcmF0aW9ucyIsMix7bWluOjAsbWF4OjZ9KSxldD1CKCJOZWFybHkgU3RyYWlnaHQgVGhyZXNob2xkIiwzMCx7bWluOjAsbWF4OjIwMH0pLEJ0PUIoIk5lYXJseSBTdHJhaWdodCBJdGVyYXRpb25zIiw4LHttaW46MCxtYXg6MTB9KSxUdD1CKCJTdG9wIEF0IFBhc3MiLDMwLHttaW46MCxtYXg6MzB9KSxTdD0xLjUsQ3Q9LjAxLE50PTEsTXQ9LjEsUj00MCxKPTEsc3Q9MixudD00LEU9MCxZPTEsRD1uZXcgUHJveHkoY29uc29sZSx7Z2V0KGEsdCl7bGV0IGU9YVt0XTtyZXR1cm4gdHlwZW9mIGUhPSJmdW5jdGlvbiI/ZToraXQ/ZS5iaW5kKGEpOigpPT57fX19KSxGPWNsYXNze2NvbnN0cnVjdG9yKHQsZSxzPXt9KXt0aGlzLnN0YWJpbGl6YXRpb25UaW1lb3V0PW51bGw7dGhpcy5sYXlvdXRGaW5hbGl6ZWQ9ITE7dGhpcy5kZWZlcnJlZEp1bXBUb0Jsb2NrPW51bGw7dGhpcy52aWV3cG9ydD10O2xldCBvPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7dGhpcy52aWV3cG9ydFNpemU9e3g6by53aWR0aCx5Om8uaGVpZ2h0fSx0aGlzLmdyYXBoQ29udGFpbmVyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLHRoaXMuZ3JhcGhDb250YWluZXIuY2xhc3NMaXN0LmFkZCgiaWctZ3JhcGgiKSx0aGlzLmdyYXBoQ29udGFpbmVyLnN0eWxlLnRyYW5zZm9ybU9yaWdpbj0idG9wIGxlZnQiLHRoaXMudmlld3BvcnQuYXBwZW5kQ2hpbGQodGhpcy5ncmFwaENvbnRhaW5lciksdGhpcy5zYW1wbGVDb3VudHM9cy5zYW1wbGVDb3VudHMsdGhpcy5tYXhTYW1wbGVDb3VudHM9WzAsMF0sdGhpcy5oZWF0bWFwTW9kZT1FO2ZvcihsZXRbbixyXW9mIHRoaXMuc2FtcGxlQ291bnRzPy50b3RhbExpbmVIaXRzPz9bXSl0aGlzLm1heFNhbXBsZUNvdW50c1tFXT1NYXRoLm1heCh0aGlzLm1heFNhbXBsZUNvdW50c1tFXSxyKTtmb3IobGV0W24scl1vZiB0aGlzLnNhbXBsZUNvdW50cz8uc2VsZkxpbmVIaXRzPz9bXSl0aGlzLm1heFNhbXBsZUNvdW50c1tZXT1NYXRoLm1heCh0aGlzLm1heFNhbXBsZUNvdW50c1tZXSxyKTt0aGlzLnNpemU9e3g6MCx5OjB9LHRoaXMubnVtTGF5ZXJzPTAsdGhpcy56b29tPTEsdGhpcy50cmFuc2xhdGlvbj17eDowLHk6MH0sdGhpcy5hbmltYXRpbmc9ITEsdGhpcy50YXJnZXRab29tPTEsdGhpcy50YXJnZXRUcmFuc2xhdGlvbj17eDowLHk6MH0sdGhpcy5zdGFydE1vdXNlUG9zPXt4OjAseTowfSx0aGlzLmxhc3RNb3VzZVBvcz17eDowLHk6MH0sdGhpcy5zZWxlY3RlZEJsb2NrUHRycz1uZXcgU2V0LHRoaXMubGFzdFNlbGVjdGVkQmxvY2tQdHI9MCx0aGlzLm5hdj17dmlzaXRlZDpbXSxjdXJyZW50SW5kZXg6LTEsc2libGluZ3M6W119LHRoaXMuaGlnaGxpZ2h0ZWRJbnN0cnVjdGlvbnM9W10sdGhpcy5pbnN0cnVjdGlvblBhbGV0dGU9cy5pbnN0cnVjdGlvblBhbGV0dGU/P1swLDEsMiwzLDRdLm1hcChuPT5gdmFyKC0taWctaGlnaGxpZ2h0LSR7bn0pYCksdGhpcy5ibG9ja3M9ZS5taXIuYmxvY2tzLm1hcChuPT57bGV0IHI9e3B0cjpuLnB0cixpZDpuLmlkLG1pcjpuLGxpcjplLmxpci5ibG9ja3MuZmluZChpPT5pLmlkPT09bi5pZCk/P251bGwscHJlZHM6W10sc3VjY3M6W10sZWw6dm9pZCAwLHNpemU6e3g6MCx5OjB9LGxheWVyOi0xLGxheW91dE5vZGU6dm9pZCAwLGlzTG9vcEhlYWRlcjohMSxpc0JhY2tlZGdlOiExLGlzUm9vdDohMSxpc09TUlRhcmdldDohMSxpc0NhdGNoRW50cnlwb2ludDohMX07cmV0dXJuIHcoci5wdHIsImJsb2NrcyBtdXN0IGFsd2F5cyBoYXZlIG5vbi1udWxsIHB0cnMiKSxyfSksdGhpcy5ibG9ja3NCeUlEPW5ldyBNYXAsdGhpcy5ibG9ja3NCeVB0cj1uZXcgTWFwLHRoaXMuaW5zUHRyc0J5SUQ9bmV3IE1hcCx0aGlzLmluc0lEc0J5UHRyPW5ldyBNYXA7Zm9yKGxldCBuIG9mIHRoaXMuYmxvY2tzKXt0aGlzLmJsb2Nrc0J5SUQuc2V0KG4uaWQsbiksdGhpcy5ibG9ja3NCeVB0ci5zZXQobi5wdHIsbik7Zm9yKGxldCByIG9mIG4ubWlyLmluc3RydWN0aW9ucyl0aGlzLmluc1B0cnNCeUlELnNldChyLmlkLHIucHRyKSx0aGlzLmluc0lEc0J5UHRyLnNldChyLnB0cixyLmlkKTtpZihuLmxpcilmb3IobGV0IHIgb2Ygbi5saXIuaW5zdHJ1Y3Rpb25zKXRoaXMuaW5zUHRyc0J5SUQuc2V0KHIuaWQsci5wdHIpLHRoaXMuaW5zSURzQnlQdHIuc2V0KHIucHRyLHIuaWQpfWZvcihsZXQgbiBvZiB0aGlzLmJsb2NrcyluLnByZWRzPW4ubWlyLnByZWRlY2Vzc29ycy5tYXAocj0+SSh0aGlzLmJsb2Nrc0J5SUQuZ2V0KHIpKSksbi5zdWNjcz1uLm1pci5zdWNjZXNzb3JzLm1hcChyPT5JKHRoaXMuYmxvY2tzQnlJRC5nZXQocikpKSxuLmlzUm9vdD1uLnByZWRzLmxlbmd0aD09PTAsbi5pc09TUlRhcmdldD1uLm1pci5hdHRyaWJ1dGVzLmluY2x1ZGVzKCJvc3IiKSxuLmlzQ2F0Y2hFbnRyeXBvaW50PW4ubWlyLmF0dHJpYnV0ZXMuaW5jbHVkZXMoImNhdGNoIik7dGhpcy5hc3NpZ25MYXllcnMoKTtmb3IobGV0IG4gb2YgdGhpcy5ibG9ja3Mpbi5lbD10aGlzLnJlbmRlckJsb2NrKG4pO2ZvcihsZXQgbiBvZiB0aGlzLmJsb2NrcyluLnNpemU9e3g6bi5lbC5vZmZzZXRXaWR0aCx5Om4uZWwub2Zmc2V0SGVpZ2h0fTt0aGlzLnJ1bkxheW91dCgpLHRoaXMuc3RhYmlsaXphdGlvblRpbWVvdXQ9d2luZG93LnNldFRpbWVvdXQoKCk9Pnt0aGlzLnN0YWJpbGl6YXRpb25UaW1lb3V0PW51bGw7bGV0IG49ITE7Zm9yKGxldCByIG9mIHRoaXMuYmxvY2tzKXtsZXQgaT1yLmVsLm9mZnNldFdpZHRoLGw9ci5lbC5vZmZzZXRIZWlnaHQ7KE1hdGguYWJzKHIuc2l6ZS54LWkpPjF8fE1hdGguYWJzKHIuc2l6ZS55LWwpPjEpJiYoci5zaXplPXt4OmkseTpsfSxuPSEwKX1uJiZ0aGlzLnJ1bkxheW91dCgpLHRoaXMubGF5b3V0RmluYWxpemVkPSEwLEQubG9nKCJHcmFwaCBsYXlvdXQgZmluYWxpemVkLiIpfSwxMDApLHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnMoKX1ydW5MYXlvdXQoKXtsZXRbdCxlLHNdPXRoaXMubGF5b3V0KCksbz1BcnJheS5mcm9tKHRoaXMuZ3JhcGhDb250YWluZXIuY2hpbGRyZW4pO2ZvcihsZXQgbiBvZiBvKW4uY2xhc3NMaXN0LmNvbnRhaW5zKCJpZy1ibG9jayIpfHxuLnJlbW92ZSgpO2lmKHRoaXMucmVuZGVyKHQsZSxzKSx0aGlzLmRlZmVycmVkSnVtcFRvQmxvY2spe2xldHtibG9ja1B0cjpuLG9wdHM6cn09dGhpcy5kZWZlcnJlZEp1bXBUb0Jsb2NrO3RoaXMuZGVmZXJyZWRKdW1wVG9CbG9jaz1udWxsLHRoaXMuanVtcFRvQmxvY2sobixyKX19bGF5b3V0KCl7bGV0IHQ9dGhpcy5tYWtlTGF5b3V0Tm9kZXMoKTt0aGlzLnN0cmFpZ2h0ZW5FZGdlcyh0KTtsZXQgZT10aGlzLmZpbmFnbGVKb2ludHModCkscz10aGlzLnZlcnRpY2FsaXplKHQsZSk7cmV0dXJuW3QscyxlXX1maW5kTGF5b3V0Um9vdHMoKXtsZXQgdD1bXSxlPVtdLHM9dGhpcy5ibG9ja3MuZmlsdGVyKG89Pm8ucHJlZHMubGVuZ3RoPT09MCk7Zm9yKGxldCBvIG9mIHMpdC5wdXNoKG8pLG8ubWlyLmF0dHJpYnV0ZXMuaW5jbHVkZXMoIm9zciIpJiZlLnB1c2gobyk7aWYodC5sZW5ndGg9PT0wJiZ0aGlzLmJsb2Nrcy5sZW5ndGg+MCl7bGV0IG89Wy4uLnRoaXMuYmxvY2tzXS5zb3J0KChuLHIpPT5uLmlkLXIuaWQpO3QucHVzaChvWzBdKX1yZXR1cm5bdCxlXX1kZXRlY3RDeWNsZXMoKXtsZXQgdD1uZXcgTWFwLGU9bmV3IE1hcCxzPW89Pnt0LnNldChvLDEpO2ZvcihsZXQgbiBvZiBvLnN1Y2NzKXtsZXQgcj10LmdldChuKT8/MDtpZihyPT09MSl7bGV0IGk9ZS5nZXQobyk7aXx8KGk9bmV3IFNldCxlLnNldChvLGkpKSxpLmFkZChuKSxvLmlzQmFja2VkZ2U9ITAsbi5pc0xvb3BIZWFkZXI9ITB9ZWxzZSByPT09MCYmcyhuKX10LnNldChvLDIpfTtmb3IobGV0IG8gb2YgdGhpcy5ibG9ja3MpdC5oYXMobyl8fHMobyk7cmV0dXJuIGV9YXNzaWduTGF5ZXJzKCl7bGV0IHQ9dGhpcy5kZXRlY3RDeWNsZXMoKTtmb3IobGV0IG8gb2YgdGhpcy5ibG9ja3Mpby5sYXllcj0tMTtsZXQgZT1vPT57aWYoby5sYXllciE9PS0xKXJldHVybiBvLmxheWVyO2xldCBuPS0xO2ZvcihsZXQgciBvZiBvLnByZWRzKXtsZXQgaT10LmdldChyKTtpZihpJiZpLmhhcyhvKSljb250aW51ZTtsZXQgbD1lKHIpO2w+biYmKG49bCl9cmV0dXJuIG8ubGF5ZXI9bisxLG8ubGF5ZXJ9LHM9MDtmb3IobGV0IG8gb2YgdGhpcy5ibG9ja3Mpe2xldCBuPWUobyk7bj5zJiYocz1uKX10aGlzLm51bUxheWVycz1zKzEsRC5sb2coYEFzc2lnbmVkIGdlbmVyaWMgbGF5ZXJzLiBNYXggbGF5ZXI6ICR7c31gKX1tYWtlTGF5b3V0Tm9kZXMoKXtELmdyb3VwKCJtYWtlTGF5b3V0Tm9kZXMiKTtmdW5jdGlvbiB0KGksbCxjKXtpLmRzdE5vZGVzW2xdPWMsYy5zcmNOb2Rlcy5pbmNsdWRlcyhpKXx8Yy5zcmNOb2Rlcy5wdXNoKGkpfWxldCBlO3tsZXQgaT17fTtmb3IobGV0IGwgb2YgdGhpcy5ibG9ja3Mpe2xldCBjPWwubGF5ZXI8MD8wOmwubGF5ZXI7aVtjXXx8KGlbY109W10pLGlbY10ucHVzaChsKX1lPU9iamVjdC5lbnRyaWVzKGkpLm1hcCgoW2wsY10pPT5bTnVtYmVyKGwpLGNdKS5zb3J0KChsLGMpPT5sWzBdLWNbMF0pLm1hcCgoW2wsY10pPT5jKX1sZXQgcz1bXTtmb3IobGV0IGk9MDtpPHRoaXMubnVtTGF5ZXJzO2krKylzW2ldPWUuZmluZChsPT5sWzBdPy5sYXllcj09PWkpfHxbXTtsZXQgbz0wLG49cy5tYXAoKCk9PltdKSxyPVtdO2ZvcihsZXRbaSxsXW9mIHMuZW50cmllcygpKXtsZXQgYz1bXTtmb3IobGV0IGQgb2YgbClmb3IobGV0IHU9ci5sZW5ndGgtMTt1Pj0wO3UtLSl7bGV0IHA9clt1XTtwLmRzdEJsb2NrPT09ZCYmKGMudW5zaGlmdChwKSxyLnNwbGljZSh1LDEpKX1sZXQgaD1uZXcgTWFwO2ZvcihsZXQgZCBvZiByKXtsZXQgdT1oLmdldChkLmRzdEJsb2NrLmlkKTt1P3QoZC5zcmMsZC5zcmNQb3J0LHUpOih1PXtpZDpvKysscG9zOnt4OkwseTpMfSxzaXplOnt4OjAseTowfSxibG9jazpudWxsLHNyY05vZGVzOltdLGRzdE5vZGVzOltdLGRzdEJsb2NrOmQuZHN0QmxvY2ssam9pbnRPZmZzZXRzOltdLGZsYWdzOjB9LHQoZC5zcmMsZC5zcmNQb3J0LHUpLG5baV0ucHVzaCh1KSxoLnNldChkLmRzdEJsb2NrLmlkLHUpKSxkLnNyYz11LGQuc3JjUG9ydD0wfWZvcihsZXQgZCBvZiBsKXtsZXQgdT17aWQ6bysrLHBvczp7eDpMLHk6TH0sc2l6ZTpkLnNpemUsYmxvY2s6ZCxzcmNOb2RlczpbXSxkc3ROb2RlczpbXSxqb2ludE9mZnNldHM6W10sZmxhZ3M6MH07ZC5sYXlvdXROb2RlPXUsbltpXS5wdXNoKHUpO2ZvcihsZXQgcCBvZiBjKXAuZHN0QmxvY2s9PT1kJiZ0KHAuc3JjLHAuc3JjUG9ydCx1KX1mb3IobGV0IGQgb2YgbClkLnN1Y2NzLmZvckVhY2goKHUscCk9PntpZih1LmxheWVyPmkpdS5sYXllcj09PWkrMT9yLnB1c2goe3NyYzpkLmxheW91dE5vZGUsc3JjUG9ydDpwLGRzdEJsb2NrOnV9KTpyLnB1c2goe3NyYzpkLmxheW91dE5vZGUsc3JjUG9ydDpwLGRzdEJsb2NrOnV9KTtlbHNle2xldCBtPWksZj11LmxheWVyLGc9ZC5sYXlvdXROb2RlLHk9cDtmb3IobGV0IHg9bTt4Pj1mO3gtLSl7bGV0IGs9e2lkOm8rKyxwb3M6e3g6TCx5Okx9LHNpemU6e3g6MCx5OjB9LGJsb2NrOm51bGwsc3JjTm9kZXM6W10sZHN0Tm9kZXM6W10sZHN0QmxvY2s6dSxqb2ludE9mZnNldHM6W10sZmxhZ3M6bnR9O25beF0ucHVzaChrKSx0KGcseSxrKSxnPWsseT0wfXUubGF5b3V0Tm9kZSYmdChnLHksdS5sYXlvdXROb2RlKX19KX1mb3IobGV0IGkgb2Ygbil7Zm9yKGxldCBsPTA7bDxpLmxlbmd0aCYmaVtsXS5ibG9jaz09PW51bGw7bCsrKWlbbF0uZmxhZ3N8PUo7Zm9yKGxldCBsPWkubGVuZ3RoLTE7bD49MCYmaVtsXS5ibG9jaz09PW51bGw7bC0tKWlbbF0uZmxhZ3N8PXN0fXJldHVybiBELmdyb3VwRW5kKCksbn1zdHJhaWdodGVuRWRnZXModCl7bGV0IGU9ZD0+e2ZvcihsZXQgdT0wO3U8ZC5sZW5ndGgtMTt1Kyspe2xldCBwPWRbdV0sbT1kW3UrMV0sZj1wLmJsb2NrPT09bnVsbCYmbS5ibG9jayE9PW51bGwsZz1wLnBvcy54K3Auc2l6ZS54KyhmP3Y6MCkrTjttLnBvcy54PU1hdGgubWF4KG0ucG9zLngsZyl9fSxzPSgpPT57bGV0IGQ9bmV3IE1hcDtmb3IobGV0IHUgb2YgWih0KSl7bGV0IHA9dS5kc3RCbG9jayxtPXUucG9zLng7ZC5zZXQocCxNYXRoLm1heChkLmdldChwKT8/MCxtKSl9Zm9yKGxldCB1IG9mIFoodCkpe2xldCBwPXUuZHN0QmxvY2ssbT1kLmdldChwKTttJiYodS5wb3MueD1tKX1mb3IobGV0IHUgb2YgdCllKHUpfSxvPSgpPT57bGV0IGQ9bmV3IE1hcDtmb3IobGV0IHUgb2YgdCl7bGV0IHA9MCxtPTA7Zm9yKDtwPHUubGVuZ3RoO3ArKylpZighKHVbcF0uZmxhZ3MmSikpe209dVtwXS5wb3MueDticmVha31mb3IocC09MSxtLT1OK3Y7cD49MDtwLS0pe2xldCBmPXVbcF0sZz1tO2ZvcihsZXQgeSBvZiBmLnNyY05vZGVzKXtsZXQgeD15LnBvcy54K3kuZHN0Tm9kZXMuaW5kZXhPZihmKSpUO3g8ZyYmKGc9eCl9Zi5wb3MueD1nLG09Zi5wb3MueC1OLGQuc2V0KGYuZHN0QmxvY2ssTWF0aC5taW4oZC5nZXQoZi5kc3RCbG9jayk/PzEvMCxnKSl9fWZvcihsZXQgdSBvZiBaKHQpKXtpZighKHUuZmxhZ3MmSikpY29udGludWU7bGV0IHA9ZC5nZXQodS5kc3RCbG9jayk7cCYmKHUucG9zLng9cCl9fSxuPSgpPT57Zm9yKGxldCBkPTA7ZDx0Lmxlbmd0aC0xO2QrKyl7bGV0IHU9dFtkXTtlKHUpO2xldCBwPS0xO2ZvcihsZXQgbSBvZiB1KWZvcihsZXRbZixnXW9mIG0uZHN0Tm9kZXMuZW50cmllcygpKXtpZighdFtkKzFdLmluY2x1ZGVzKGcpKWNvbnRpbnVlO2xldCB5PXRbZCsxXS5pbmRleE9mKGcpO2lmKHk+cCYmZy5zcmNOb2Rlc1swXT09PW0pe2xldCB4PXYrVCpmLGs9dixQPWcucG9zLng7Zy5wb3MueD1NYXRoLm1heChnLnBvcy54LG0ucG9zLngreC1rKSxnLnBvcy54IT09UCYmKHA9eSl9fX19LHI9KCk9Pntmb3IobGV0IGQgb2YgdCl7Zm9yKGxldCB1PWQubGVuZ3RoLTE7dT49MDt1LS0pe2xldCBwPWRbdV07aWYoIXAuYmxvY2t8fHAuYmxvY2suaXNMb29wSGVhZGVyKWNvbnRpbnVlO2xldCBtPVtdO2ZvcihsZXQgZiBvZiBwLnNyY05vZGVzKXtsZXQgZz12K2YuZHN0Tm9kZXMuaW5kZXhPZihwKSpULHk9djttLnB1c2goZi5wb3MueCtnLShwLnBvcy54K3kpKX1mb3IobGV0W2YsZ11vZiBwLmRzdE5vZGVzLmVudHJpZXMoKSl7aWYoZy5ibG9jaz09PW51bGwmJmcuZHN0QmxvY2suaXNMb29wSGVhZGVyKWNvbnRpbnVlO2xldCB5PXYrZipULHg9djttLnB1c2goZy5wb3MueCt4LShwLnBvcy54K3kpKX1pZighbS5pbmNsdWRlcygwKSl7bT1tLmZpbHRlcihmPT5mPjApLnNvcnQoKGYsZyk9PmYtZyk7Zm9yKGxldCBmIG9mIG0pe2xldCBnPSExO2ZvcihsZXQgeT11KzE7eTxkLmxlbmd0aDt5Kyspe2xldCB4PWRbeV07aWYoeC5mbGFncyZzdCljb250aW51ZTtsZXQgaz1wLnBvcy54K2YsUD1wLnBvcy54K2YrcC5zaXplLngsYXQ9eC5wb3MueC1OLGx0PXgucG9zLngreC5zaXplLngrTjtQPj1hdCYmazw9bHQmJihnPSEwKX1pZighZyl7cC5wb3MueCs9ZjticmVha319fX1lKGQpfX0saT0oKT0+e2ZvcihsZXQgZD10Lmxlbmd0aC0xO2Q+PTA7ZC0tKXtsZXQgdT10W2RdO2UodSk7Zm9yKGxldCBwIG9mIHUpZm9yKGxldCBtIG9mIHAuc3JjTm9kZXMpe2lmKG0uYmxvY2shPT1udWxsKWNvbnRpbnVlO01hdGguYWJzKG0ucG9zLngtcC5wb3MueCk8PWV0JiYobS5wb3MueD1NYXRoLm1heChtLnBvcy54LHAucG9zLngpLHAucG9zLng9TWF0aC5tYXgobS5wb3MueCxwLnBvcy54KSl9fX0sbD0oKT0+e2ZvcihsZXQgZD0wO2Q8dC5sZW5ndGg7ZCsrKXtsZXQgdT10W2RdO2UodSk7Zm9yKGxldCBwIG9mIHUpe2lmKHAuZHN0Tm9kZXMubGVuZ3RoPT09MCljb250aW51ZTtsZXQgbT1wLmRzdE5vZGVzWzBdO2lmKG0uYmxvY2shPT1udWxsKWNvbnRpbnVlO01hdGguYWJzKG0ucG9zLngtcC5wb3MueCk8PWV0JiYobS5wb3MueD1NYXRoLm1heChtLnBvcy54LHAucG9zLngpLHAucG9zLng9TWF0aC5tYXgobS5wb3MueCxwLnBvcy54KSl9fX07ZnVuY3Rpb24gYyhkLHUpe2xldCBwPVtdO2ZvcihsZXQgbT0wO208dTttKyspZm9yKGxldCBmIG9mIGQpcC5wdXNoKGYpO3JldHVybiBwfWxldCBoPVsuLi5jKFtuLHNdLEl0KSxzLC4uLmMoW2ksbF0sQnQpLHIscyxvXTtmb3IobGV0W2QsdV1vZiBoLmVudHJpZXMoKSlkPFR0JiZ1KCl9ZmluYWdsZUpvaW50cyh0KXtsZXQgZT1bXTtmb3IobGV0IHMgb2YgdCl7bGV0IG89W107Zm9yKGxldCBjIG9mIHMpe2Muam9pbnRPZmZzZXRzPW5ldyBBcnJheShjLmRzdE5vZGVzLmxlbmd0aCkuZmlsbCgwKTtmb3IobGV0W2gsZF1vZiBjLmRzdE5vZGVzLmVudHJpZXMoKSl7aWYoZC5wb3MueTxjLnBvcy55KWNvbnRpbnVlO2xldCB1PWMucG9zLngrditUKmgscD1kLnBvcy54K3Y7TWF0aC5hYnMocC11KTwyKiR8fG8ucHVzaCh7eDE6dSx4MjpwLHNyYzpjLHNyY1BvcnQ6aCxkc3Q6ZH0pfX1vLnNvcnQoKGMsaCk9PmMueDEtaC54MSk7bGV0IG49W10scj1bXTt0OmZvcihsZXQgYyBvZiBvKXtsZXQgaD1jLngyLWMueDE+PTA/bjpyLGQ9bnVsbDtmb3IobGV0IHU9aC5sZW5ndGgtMTt1Pj0wO3UtLSl7bGV0IHA9aFt1XSxtPSExO2ZvcihsZXQgZiBvZiBwKXtpZihjLmRzdD09PWYuZHN0KXtwLnB1c2goYyk7Y29udGludWUgdH1sZXQgZz1NYXRoLm1pbihjLngxLGMueDIpLHk9TWF0aC5tYXgoYy54MSxjLngyKSx4PU1hdGgubWluKGYueDEsZi54Miksaz1NYXRoLm1heChmLngxLGYueDIpO2lmKHk+PXgmJmc8PWspe209ITA7YnJlYWt9fWlmKG0pYnJlYWs7ZD1wfWQ/ZC5wdXNoKGMpOmgucHVzaChbY10pfWxldCBpPU1hdGgubWF4KDAsbi5sZW5ndGgrci5sZW5ndGgtMSkqdHQsbD0taS8yO2ZvcihsZXQgYyBvZlsuLi5uLnJldmVyc2UoKSwuLi5yXSl7Zm9yKGxldCBoIG9mIGMpaC5zcmMuam9pbnRPZmZzZXRzW2guc3JjUG9ydF09bDtsKz10dH1lLnB1c2goaSl9cmV0dXJuIGV9dmVydGljYWxpemUodCxlKXtsZXQgcz1uZXcgQXJyYXkodC5sZW5ndGgpLG89TDtmb3IobGV0IG49MDtuPHQubGVuZ3RoO24rKyl7bGV0IHI9dFtuXSxpPTA7Zm9yKGxldCBsIG9mIHIpbC5wb3MueT1vLGk9TWF0aC5tYXgoaSxsLnNpemUueSk7c1tuXT1pLG8rPWkrTStlW25dK019cmV0dXJuIHN9cmVuZGVyQmxvY2sodCl7bGV0IGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7dGhpcy5ncmFwaENvbnRhaW5lci5hcHBlbmRDaGlsZChlKSxlLmNsYXNzTGlzdC5hZGQoImlnLWJsb2NrIiwiaWctYmctd2hpdGUiKTtmb3IobGV0IGkgb2YgdC5taXIuYXR0cmlidXRlcyllLmNsYXNzTGlzdC5hZGQoYGlnLWJsb2NrLWF0dC0ke2l9YCk7ZS5zZXRBdHRyaWJ1dGUoImRhdGEtaWctYmxvY2stcHRyIixgJHt0LnB0cn1gKSxlLnNldEF0dHJpYnV0ZSgiZGF0YS1pZy1ibG9jay1pZCIsYCR7dC5pZH1gKTtsZXQgcz1bXTt0LmlzUm9vdCYmKHMucHVzaCgiKHJvb3QpIiksZS5jbGFzc0xpc3QuYWRkKCJpZy1ibG9jay1hdHQtcm9vdCIpKSx0LmlzQ2F0Y2hFbnRyeXBvaW50JiZzLnB1c2goIihjYXRjaCkiKSx0LmlzT1NSVGFyZ2V0JiZzLnB1c2goIihvc3IpIiksdC5pc0xvb3BIZWFkZXImJihzLnB1c2goIihsb29wIGhlYWRlcikiKSxlLmNsYXNzTGlzdC5hZGQoImlnLWJsb2NrLWF0dC1sb29waGVhZGVyIikpLHQuaXNCYWNrZWRnZSYmKHMucHVzaCgiKGJhY2tlZGdlKSIpLGUuY2xhc3NMaXN0LmFkZCgiaWctYmxvY2stYXR0LWJhY2tlZGdlIikpO2xldCBvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO28uY2xhc3NMaXN0LmFkZCgiaWctYmxvY2staGVhZGVyIiksby5pbm5lclRleHQ9YEJsb2NrICR7dC5pZH0ke3MubGVuZ3RoPT09MD8iIjoiICIrcy5qb2luKCIgIil9YCxlLmFwcGVuZENoaWxkKG8pO2xldCBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO24uY2xhc3NMaXN0LmFkZCgiaWctaW5zdHJ1Y3Rpb25zIiksZS5hcHBlbmRDaGlsZChuKTtsZXQgcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0YWJsZSIpO2lmKHQubGlyKXtyLmlubmVySFRNTD1gCiAgICAgICAgPGNvbGdyb3VwPgogICAgICAgICAgPGNvbCBzdHlsZT0id2lkdGg6IDFweCI+CiAgICAgICAgICA8Y29sIHN0eWxlPSJ3aWR0aDogYXV0byI+CiAgICAgICAgICAke3RoaXMuc2FtcGxlQ291bnRzP2AKICAgICAgICAgICAgPGNvbCBzdHlsZT0id2lkdGg6IDFweCI+CiAgICAgICAgICAgIDxjb2wgc3R5bGU9IndpZHRoOiAxcHgiPgogICAgICAgICAgYDoiIn0KICAgICAgICA8L2NvbGdyb3VwPgogICAgICAgICR7dGhpcy5zYW1wbGVDb3VudHM/YAogICAgICAgICAgPHRoZWFkPgogICAgICAgICAgICA8dHI+CiAgICAgICAgICAgICAgPHRoPjwvdGg+CiAgICAgICAgICAgICAgPHRoPjwvdGg+CiAgICAgICAgICAgICAgPHRoIGNsYXNzPSJpZy1mNiI+VG90YWw8L3RoPgogICAgICAgICAgICAgIDx0aCBjbGFzcz0iaWctZjYiPlNlbGY8L3RoPgogICAgICAgICAgICA8L3RyPgogICAgICAgICAgPC90aGVhZD4KICAgICAgICBgOiIifQogICAgICBgO2ZvcihsZXQgaSBvZiB0Lmxpci5pbnN0cnVjdGlvbnMpci5hcHBlbmRDaGlsZCh0aGlzLnJlbmRlckxJUkluc3RydWN0aW9uKGkpKX1lbHNle3IuaW5uZXJIVE1MPWAKICAgICAgICA8Y29sZ3JvdXA+CiAgICAgICAgICA8Y29sIHN0eWxlPSJ3aWR0aDogMXB4Ij4KICAgICAgICAgIDxjb2wgc3R5bGU9IndpZHRoOiBhdXRvIj4KICAgICAgICAgIDxjb2wgc3R5bGU9IndpZHRoOiAxcHgiPgogICAgICAgIDwvY29sZ3JvdXA+CiAgICAgIGA7Zm9yKGxldCBpIG9mIHQubWlyLmluc3RydWN0aW9ucylyLmFwcGVuZENoaWxkKHRoaXMucmVuZGVyTUlSSW5zdHJ1Y3Rpb24oaSkpfW4uYXBwZW5kQ2hpbGQocik7Zm9yKGxldFtpLGxdb2YgdC5zdWNjcy5lbnRyaWVzKCkpe2xldCBjPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO2MuaW5uZXJUZXh0PWAjJHtsLmlkfWAsYy5jbGFzc0xpc3QuYWRkKCJpZy1lZGdlLWxhYmVsIiksYy5zdHlsZS5sZWZ0PWAke3YrVCppfXB4YCxlLmFwcGVuZENoaWxkKGMpfXJldHVybiBvLmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIixpPT57aS5wcmV2ZW50RGVmYXVsdCgpLGkuc3RvcFByb3BhZ2F0aW9uKCl9KSxvLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIixpPT57aS5zdG9wUHJvcGFnYXRpb24oKSxpLnNoaWZ0S2V5fHx0aGlzLnNlbGVjdGVkQmxvY2tQdHJzLmNsZWFyKCksdGhpcy5zZXRTZWxlY3Rpb24oW10sdC5wdHIpfSksZX1yZW5kZXIodCxlLHMpe2ZvcihsZXQgbCBvZiB0KWZvcihsZXQgYyBvZiBsKWlmKGMuYmxvY2shPT1udWxsKXtsZXQgaD1jLmJsb2NrO2guZWwuc3R5bGUubGVmdD1gJHtjLnBvcy54fXB4YCxoLmVsLnN0eWxlLnRvcD1gJHtjLnBvcy55fXB4YH1sZXQgbz0wLG49MDtmb3IobGV0IGwgb2YgdClmb3IobGV0IGMgb2YgbClvPU1hdGgubWF4KG8sYy5wb3MueCtjLnNpemUueCtMKSxuPU1hdGgubWF4KG4sYy5wb3MueStjLnNpemUueStMKTtsZXQgcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwic3ZnIik7dGhpcy5ncmFwaENvbnRhaW5lci5hcHBlbmRDaGlsZChyKTtsZXQgaT0obCxjKT0+e2ZvcihsZXQgaCBvZiBsKW89TWF0aC5tYXgobyxoK0wpO2ZvcihsZXQgaCBvZiBjKW49TWF0aC5tYXgobixoK0wpfTtmb3IobGV0IGw9MDtsPHQubGVuZ3RoO2wrKyl7bGV0IGM9dFtsXTtmb3IobGV0IGggb2YgYyl7dyhoLmRzdE5vZGVzLmxlbmd0aD09PWguam9pbnRPZmZzZXRzLmxlbmd0aCwibXVzdCBoYXZlIGEgam9pbnQgb2Zmc2V0IGZvciBlYWNoIGRlc3RpbmF0aW9uIik7Zm9yKGxldFtkLHVdb2YgaC5kc3ROb2Rlcy5lbnRyaWVzKCkpe2xldCBwPWgucG9zLngrditUKmQsbT1oLnBvcy55K2guc2l6ZS55LGY9dS5wb3MueCt2LGc9dS5wb3MueSx5PWc8bSx4PWs9PihrLmZsYWdzJm50KSE9PTA7aWYoaC5ibG9jayYmdS5ibG9jaz09PW51bGwmJnkpe2xldCBrPW0rTSxQPUh0KHAsbSxmLGcsayk7ci5hcHBlbmRDaGlsZChQKSxpKFtwLGZdLFttLGcsa10pfWVsc2UgaWYoaC5ibG9jaz09PW51bGwmJnUuYmxvY2shPT1udWxsJiZNYXRoLmFicyhtLWcpPDEpe2xldCBrPWctTHQsUD1BdChwLG0sZixnLGspO3IuYXBwZW5kQ2hpbGQoUCksaShbcCxmXSxbbSxnLGtdKX1lbHNlIGlmKHkpe2xldCBrPW0tTSxQPSR0KHAsbSxmLGcsayx1LmJsb2NrIT09bnVsbCk7ci5hcHBlbmRDaGlsZChQKSxpKFtwLGZdLFttLGcsa10pfWVsc2V7bGV0IGs9bS1oLnNpemUueStlW2xdK00rc1tsXS8yK2guam9pbnRPZmZzZXRzW2RdLFA9RXQocCxtLGYsZyxrLHUuYmxvY2shPT1udWxsKTtyLmFwcGVuZENoaWxkKFApLGkoW3AsZl0sW20sZyxrXSl9fX19aWYoci5zZXRBdHRyaWJ1dGUoIndpZHRoIixgJHtvfWApLHIuc2V0QXR0cmlidXRlKCJoZWlnaHQiLGAke259YCksdGhpcy5zaXplPXt4Om8seTpufSwraXQpZm9yKGxldCBsIG9mIHQpZm9yKGxldCBjIG9mIGwpe2xldCBoPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO2guYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoU3RyaW5nKGMuaWQpKSksaC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJiciIpKSxoLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGBMOiR7Yy5ibG9jaz8ubGF5ZXJ9YCkpLGguYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnIiKSksaC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShgPC0gJHtjLnNyY05vZGVzLm1hcChkPT5kLmlkKX1gKSksaC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJiciIpKSxoLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGAtPiAke2MuZHN0Tm9kZXMubWFwKGQ9PmQuaWQpfWApKSxoLnN0eWxlLnBvc2l0aW9uPSJhYnNvbHV0ZSIsaC5zdHlsZS5ib3JkZXI9IjFweCBzb2xpZCBibGFjayIsaC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9IndoaXRlIixoLnN0eWxlLmxlZnQ9YCR7Yy5wb3MueH1weGAsaC5zdHlsZS50b3A9YCR7Yy5wb3MueX1weGAsaC5zdHlsZS53aGl0ZVNwYWNlPSJub3dyYXAiLHRoaXMuZ3JhcGhDb250YWluZXIuYXBwZW5kQ2hpbGQoaCl9dGhpcy51cGRhdGVIaWdobGlnaHRlZEluc3RydWN0aW9ucygpLHRoaXMudXBkYXRlSG90bmVzcygpfXJlbmRlck1JUkluc3RydWN0aW9uKHQpe2xldCBlPXQub3Bjb2RlLnJlcGxhY2UoIi0+IiwiXHUyMTkyIikucmVwbGFjZSgiPC0iLCJcdTIxOTAiKSxzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRyIik7cy5jbGFzc0xpc3QuYWRkKCJpZy1pbnMiLCJpZy1pbnMtbWlyIiwiaWctY2FuLWZsYXNoIiwuLi50LmF0dHJpYnV0ZXMubWFwKGg9PmBpZy1pbnMtYXR0LSR7aH1gKSkscy5zZXRBdHRyaWJ1dGUoImRhdGEtaWctaW5zLXB0ciIsYCR7dC5wdHJ9YCkscy5zZXRBdHRyaWJ1dGUoImRhdGEtaWctaW5zLWlkIixgJHt0LmlkfWApO2xldCBvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRkIik7by5jbGFzc0xpc3QuYWRkKCJpZy1pbnMtbnVtIiksby5pbm5lclRleHQ9U3RyaW5nKHQuaWQpLHMuYXBwZW5kQ2hpbGQobyk7bGV0IG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGQiKSxyPS8oW0EtWmEtejAtOV88Pl0rKSMoXGQrKS9nLGk9MCxsO2Zvcig7KGw9ci5leGVjKGUpKSE9PW51bGw7KXtpZihsLmluZGV4Pmkpe2xldCBkPWUuc3Vic3RyaW5nKGksbC5pbmRleCk7bi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkKSl9bGV0IGg9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3BhbiIpO2guY2xhc3NOYW1lPSJpZy11c2UgaWctaGlnaGxpZ2h0YWJsZSIsaC5zZXRBdHRyaWJ1dGUoImRhdGEtaWctdXNlIixlbmNvZGVVUklDb21wb25lbnQobFsyXSkpLGgudGV4dENvbnRlbnQ9YCR7bFsxXX0jJHtsWzJdfWAsbi5hcHBlbmRDaGlsZChoKSxpPXIubGFzdEluZGV4fWlmKGk8ZS5sZW5ndGgpe2xldCBoPWUuc3Vic3RyaW5nKGkpO24uYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoaCkpfXMuYXBwZW5kQ2hpbGQobik7bGV0IGM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGQiKTtyZXR1cm4gYy5jbGFzc0xpc3QuYWRkKCJpZy1pbnMtdHlwZSIpLGMuaW5uZXJUZXh0PXQudHlwZT09PSJOb25lIj8iIjp0LnR5cGUscy5hcHBlbmRDaGlsZChjKSxvLmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIixoPT57aC5wcmV2ZW50RGVmYXVsdCgpLGguc3RvcFByb3BhZ2F0aW9uKCl9KSxvLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoKT0+e3RoaXMudG9nZ2xlSW5zdHJ1Y3Rpb25IaWdobGlnaHQodC5wdHIpfSksbi5xdWVyeVNlbGVjdG9yQWxsKCIuaWctdXNlIikuZm9yRWFjaChoPT57aC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsZD0+e2QucHJldmVudERlZmF1bHQoKSxkLnN0b3BQcm9wYWdhdGlvbigpfSksaC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsZD0+e2xldCB1PXBhcnNlSW50KEkoaC5nZXRBdHRyaWJ1dGUoImRhdGEtaWctdXNlIikpLDEwKTt0aGlzLmp1bXBUb0luc3RydWN0aW9uKHUse3pvb206MX0pfSl9KSxzfXJlbmRlckxJUkluc3RydWN0aW9uKHQpe2xldCBlPXQub3Bjb2RlLnJlcGxhY2UoIi0+IiwiXHUyMTkyIikucmVwbGFjZSgiPC0iLCJcdTIxOTAiKSxzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRyIik7cy5jbGFzc0xpc3QuYWRkKCJpZy1pbnMiLCJpZy1pbnMtbGlyIiwiaWctaG90bmVzcyIpLHMuc2V0QXR0cmlidXRlKCJkYXRhLWlnLWlucy1wdHIiLGAke3QucHRyfWApLHMuc2V0QXR0cmlidXRlKCJkYXRhLWlnLWlucy1pZCIsYCR7dC5pZH1gKTtsZXQgbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZCIpO28uY2xhc3NMaXN0LmFkZCgiaWctaW5zLW51bSIpLG8uaW5uZXJUZXh0PVN0cmluZyh0LmlkKSxzLmFwcGVuZENoaWxkKG8pO2xldCBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRkIik7aWYobi5pbm5lclRleHQ9ZSxzLmFwcGVuZENoaWxkKG4pLHRoaXMuc2FtcGxlQ291bnRzKXtsZXQgcj10aGlzLnNhbXBsZUNvdW50cz8udG90YWxMaW5lSGl0cy5nZXQodC5pZCk/PzAsaT10aGlzLnNhbXBsZUNvdW50cz8uc2VsZkxpbmVIaXRzLmdldCh0LmlkKT8/MCxsPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRkIik7bC5jbGFzc0xpc3QuYWRkKCJpZy1pbnMtc2FtcGxlcyIpLGwuY2xhc3NMaXN0LnRvZ2dsZSgiaWctdGV4dC1kaW0iLHI9PT0wKSxsLmlubmVyVGV4dD1gJHtyfWAsbC50aXRsZT0iQ29sb3IgYnkgdG90YWwgY291bnQiLHMuYXBwZW5kQ2hpbGQobCk7bGV0IGM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGQiKTtjLmNsYXNzTGlzdC5hZGQoImlnLWlucy1zYW1wbGVzIiksYy5jbGFzc0xpc3QudG9nZ2xlKCJpZy10ZXh0LWRpbSIsaT09PTApLGMuaW5uZXJUZXh0PWAke2l9YCxjLnRpdGxlPSJDb2xvciBieSBzZWxmIGNvdW50IixzLmFwcGVuZENoaWxkKGMpO2ZvcihsZXRbaCxkXW9mW2wsY10uZW50cmllcygpKWQuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLHU9Pnt1LnByZXZlbnREZWZhdWx0KCksdS5zdG9wUHJvcGFnYXRpb24oKX0pLGQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCgpPT57dyhoPT09RXx8aD09PVkpLHRoaXMuaGVhdG1hcE1vZGU9aCx0aGlzLnVwZGF0ZUhvdG5lc3MoKX0pfXJldHVybiBvLmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIixyPT57ci5wcmV2ZW50RGVmYXVsdCgpLHIuc3RvcFByb3BhZ2F0aW9uKCl9KSxvLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoKT0+e3RoaXMudG9nZ2xlSW5zdHJ1Y3Rpb25IaWdobGlnaHQodC5wdHIpfSksc31yZW5kZXJTZWxlY3Rpb24oKXt0aGlzLmdyYXBoQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoIi5pZy1ibG9jayIpLmZvckVhY2godD0+e2xldCBlPXBhcnNlSW50KEkodC5nZXRBdHRyaWJ1dGUoImRhdGEtaWctYmxvY2stcHRyIikpLDEwKTt0LmNsYXNzTGlzdC50b2dnbGUoImlnLXNlbGVjdGVkIix0aGlzLnNlbGVjdGVkQmxvY2tQdHJzLmhhcyhlKSksdC5jbGFzc0xpc3QudG9nZ2xlKCJpZy1sYXN0LXNlbGVjdGVkIix0aGlzLmxhc3RTZWxlY3RlZEJsb2NrUHRyPT09ZSl9KX1yZW1vdmVOb25leGlzdGVudEhpZ2hsaWdodHMoKXt0aGlzLmhpZ2hsaWdodGVkSW5zdHJ1Y3Rpb25zPXRoaXMuaGlnaGxpZ2h0ZWRJbnN0cnVjdGlvbnMuZmlsdGVyKHQ9PnRoaXMuZ3JhcGhDb250YWluZXIucXVlcnlTZWxlY3RvcihgLmlnLWluc1tkYXRhLWlnLWlucy1wdHI9IiR7dC5wdHJ9Il1gKSl9dXBkYXRlSGlnaGxpZ2h0ZWRJbnN0cnVjdGlvbnMoKXtmb3IobGV0IHQgb2YgdGhpcy5oaWdobGlnaHRlZEluc3RydWN0aW9ucyl3KHRoaXMuaGlnaGxpZ2h0ZWRJbnN0cnVjdGlvbnMuZmlsdGVyKGU9PmUucHRyPT09dC5wdHIpLmxlbmd0aD09PTEsYGluc3RydWN0aW9uICR7dC5wdHJ9IHdhcyBoaWdobGlnaHRlZCBtb3JlIHRoYW4gb25jZWApO3RoaXMuZ3JhcGhDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgiLmlnLWlucywgLmlnLXVzZSIpLmZvckVhY2godD0+e090KHQpfSk7Zm9yKGxldCB0IG9mIHRoaXMuaGlnaGxpZ2h0ZWRJbnN0cnVjdGlvbnMpe2xldCBlPXRoaXMuaW5zdHJ1Y3Rpb25QYWxldHRlW3QucGFsZXR0ZUNvbG9yJXRoaXMuaW5zdHJ1Y3Rpb25QYWxldHRlLmxlbmd0aF0scz10aGlzLmdyYXBoQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoYC5pZy1pbnNbZGF0YS1pZy1pbnMtcHRyPSIke3QucHRyfSJdYCk7aWYocyl7b3QocyxlKTtsZXQgbz10aGlzLmluc0lEc0J5UHRyLmdldCh0LnB0cik7dGhpcy5ncmFwaENvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKGAuaWctdXNlW2RhdGEtaWctdXNlPSIke299Il1gKS5mb3JFYWNoKG49PntvdChuLGUpfSl9fX11cGRhdGVIb3RuZXNzKCl7dGhpcy5ncmFwaENvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCIuaWctaW5zLWxpciIpLmZvckVhY2godD0+e3codC5jbGFzc0xpc3QuY29udGFpbnMoImlnLWhvdG5lc3MiKSk7bGV0IGU9cGFyc2VJbnQoSSh0LmdldEF0dHJpYnV0ZSgiZGF0YS1pZy1pbnMtaWQiKSksMTApLHM9MDt0aGlzLnNhbXBsZUNvdW50cyYmKHM9KCh0aGlzLmhlYXRtYXBNb2RlPT09RT90aGlzLnNhbXBsZUNvdW50cy50b3RhbExpbmVIaXRzOnRoaXMuc2FtcGxlQ291bnRzLnNlbGZMaW5lSGl0cykuZ2V0KGUpPz8wKS90aGlzLm1heFNhbXBsZUNvdW50c1t0aGlzLmhlYXRtYXBNb2RlXSksdC5zdHlsZS5zZXRQcm9wZXJ0eSgiLS1pZy1ob3RuZXNzIixgJHtzfWApfSl9YWRkRXZlbnRMaXN0ZW5lcnMoKXt0aGlzLnZpZXdwb3J0LmFkZEV2ZW50TGlzdGVuZXIoIndoZWVsIixlPT57ZS5wcmV2ZW50RGVmYXVsdCgpO2xldCBzPXRoaXMuem9vbTtpZihlLmN0cmxLZXkpe3M9TWF0aC5tYXgoTXQsTWF0aC5taW4oTnQsdGhpcy56b29tKk1hdGgucG93KFN0LC1lLmRlbHRhWSpDdCkpKTtsZXQgbj1zL3RoaXMuem9vbS0xO3RoaXMuem9vbT1zO2xldHt4OnIseTppfT10aGlzLnZpZXdwb3J0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGw9ZS5jbGllbnRYLXItdGhpcy50cmFuc2xhdGlvbi54LGM9ZS5jbGllbnRZLWktdGhpcy50cmFuc2xhdGlvbi55O3RoaXMudHJhbnNsYXRpb24ueC09bCpuLHRoaXMudHJhbnNsYXRpb24ueS09YypufWVsc2UgdGhpcy50cmFuc2xhdGlvbi54LT1lLmRlbHRhWCx0aGlzLnRyYW5zbGF0aW9uLnktPWUuZGVsdGFZO2xldCBvPXRoaXMuY2xhbXBUcmFuc2xhdGlvbih0aGlzLnRyYW5zbGF0aW9uLHMpO3RoaXMudHJhbnNsYXRpb24ueD1vLngsdGhpcy50cmFuc2xhdGlvbi55PW8ueSx0aGlzLmFuaW1hdGluZz0hMSx0aGlzLnVwZGF0ZVBhbkFuZFpvb20oKX0pLHRoaXMudmlld3BvcnQuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLGU9PntlLnBvaW50ZXJUeXBlPT09Im1vdXNlIiYmIShlLmJ1dHRvbj09PTB8fGUuYnV0dG9uPT09MSl8fChlLnByZXZlbnREZWZhdWx0KCksdGhpcy52aWV3cG9ydC5zZXRQb2ludGVyQ2FwdHVyZShlLnBvaW50ZXJJZCksdGhpcy5zdGFydE1vdXNlUG9zPXt4OmUuY2xpZW50WCx5OmUuY2xpZW50WX0sdGhpcy5sYXN0TW91c2VQb3M9e3g6ZS5jbGllbnRYLHk6ZS5jbGllbnRZfSx0aGlzLmFuaW1hdGluZz0hMSl9KSx0aGlzLnZpZXdwb3J0LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIixlPT57aWYoIXRoaXMudmlld3BvcnQuaGFzUG9pbnRlckNhcHR1cmUoZS5wb2ludGVySWQpKXJldHVybjtsZXQgcz1lLmNsaWVudFgtdGhpcy5sYXN0TW91c2VQb3MueCxvPWUuY2xpZW50WS10aGlzLmxhc3RNb3VzZVBvcy55O3RoaXMudHJhbnNsYXRpb24ueCs9cyx0aGlzLnRyYW5zbGF0aW9uLnkrPW8sdGhpcy5sYXN0TW91c2VQb3M9e3g6ZS5jbGllbnRYLHk6ZS5jbGllbnRZfTtsZXQgbj10aGlzLmNsYW1wVHJhbnNsYXRpb24odGhpcy50cmFuc2xhdGlvbix0aGlzLnpvb20pO3RoaXMudHJhbnNsYXRpb24ueD1uLngsdGhpcy50cmFuc2xhdGlvbi55PW4ueSx0aGlzLmFuaW1hdGluZz0hMSx0aGlzLnVwZGF0ZVBhbkFuZFpvb20oKX0pLHRoaXMudmlld3BvcnQuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIixlPT57dGhpcy52aWV3cG9ydC5yZWxlYXNlUG9pbnRlckNhcHR1cmUoZS5wb2ludGVySWQpO2xldCBzPTIsbz10aGlzLnN0YXJ0TW91c2VQb3MueC1lLmNsaWVudFgsbj10aGlzLnN0YXJ0TW91c2VQb3MueS1lLmNsaWVudFk7TWF0aC5hYnMobyk8PXMmJk1hdGguYWJzKG4pPD1zJiZ0aGlzLnNldFNlbGVjdGlvbihbXSksdGhpcy5hbmltYXRpbmc9ITF9KSxuZXcgUmVzaXplT2JzZXJ2ZXIoZT0+e3coZS5sZW5ndGg9PT0xKTtsZXQgcz1lWzBdLmNvbnRlbnRSZWN0O3RoaXMudmlld3BvcnRTaXplLng9cy53aWR0aCx0aGlzLnZpZXdwb3J0U2l6ZS55PXMuaGVpZ2h0fSkub2JzZXJ2ZSh0aGlzLnZpZXdwb3J0KX1zZXRTZWxlY3Rpb24odCxlPTApe3RoaXMuc2V0U2VsZWN0aW9uUmF3KHQsZSksZT90aGlzLm5hdj17dmlzaXRlZDpbZV0sY3VycmVudEluZGV4OjAsc2libGluZ3M6W2VdfTp0aGlzLm5hdj17dmlzaXRlZDpbXSxjdXJyZW50SW5kZXg6LTEsc2libGluZ3M6W119fXNldFNlbGVjdGlvblJhdyh0LGUpe3RoaXMuc2VsZWN0ZWRCbG9ja1B0cnMuY2xlYXIoKTtmb3IobGV0IHMgb2ZbLi4udCxlXSl0aGlzLmJsb2Nrc0J5UHRyLmhhcyhzKSYmdGhpcy5zZWxlY3RlZEJsb2NrUHRycy5hZGQocyk7dGhpcy5sYXN0U2VsZWN0ZWRCbG9ja1B0cj10aGlzLmJsb2Nrc0J5UHRyLmhhcyhlKT9lOjAsdGhpcy5yZW5kZXJTZWxlY3Rpb24oKX1uYXZpZ2F0ZSh0KXtsZXQgZT10aGlzLmxhc3RTZWxlY3RlZEJsb2NrUHRyO2lmKHQ9PT0iZG93biJ8fHQ9PT0idXAiKWlmKGUpe2xldCBzPUkodGhpcy5ibG9ja3NCeVB0ci5nZXQoZSkpLG89KHQ9PT0iZG93biI/cy5zdWNjczpzLnByZWRzKS5tYXAocj0+ci5wdHIpO3MucHRyIT09dGhpcy5uYXYudmlzaXRlZFt0aGlzLm5hdi5jdXJyZW50SW5kZXhdJiYodGhpcy5uYXYudmlzaXRlZD1bcy5wdHJdLHRoaXMubmF2LmN1cnJlbnRJbmRleD0wKTtsZXQgbj10aGlzLm5hdi5jdXJyZW50SW5kZXgrKHQ9PT0iZG93biI/MTotMSk7aWYoMDw9biYmbjx0aGlzLm5hdi52aXNpdGVkLmxlbmd0aCl0aGlzLm5hdi5jdXJyZW50SW5kZXg9bix0aGlzLm5hdi5zaWJsaW5ncz1vO2Vsc2V7bGV0IHI9b1swXTtyIT09dm9pZCAwJiYodD09PSJkb3duIj8odGhpcy5uYXYudmlzaXRlZC5wdXNoKHIpLHRoaXMubmF2LmN1cnJlbnRJbmRleCs9MSx3KHRoaXMubmF2LmN1cnJlbnRJbmRleD09PXRoaXMubmF2LnZpc2l0ZWQubGVuZ3RoLTEpKToodGhpcy5uYXYudmlzaXRlZC51bnNoaWZ0KHIpLHcodGhpcy5uYXYuY3VycmVudEluZGV4PT09MCkpLHRoaXMubmF2LnNpYmxpbmdzPW8pfXRoaXMuc2V0U2VsZWN0aW9uUmF3KFtdLHRoaXMubmF2LnZpc2l0ZWRbdGhpcy5uYXYuY3VycmVudEluZGV4XSl9ZWxzZXtsZXQgcz1bLi4udGhpcy5ibG9ja3NdLnNvcnQoKGwsYyk9PmwuaWQtYy5pZCksbz1zLmZpbHRlcihsPT5sLnByZWRzLmxlbmd0aD09PTApLG49cy5maWx0ZXIobD0+bC5zdWNjcy5sZW5ndGg9PT0wKSxyPXQ9PT0iZG93biI/bzpuLGk9clswXTt3KGkpLHRoaXMuc2V0U2VsZWN0aW9uUmF3KFtdLGkucHRyKSx0aGlzLm5hdj17dmlzaXRlZDpbaS5wdHJdLGN1cnJlbnRJbmRleDowLHNpYmxpbmdzOnIubWFwKGw9PmwucHRyKX19ZWxzZSBpZihlIT09dm9pZCAwKXtsZXQgcz10aGlzLm5hdi5zaWJsaW5ncy5pbmRleE9mKGUpO3cocz49MCwiY3VycmVudGx5IHNlbGVjdGVkIG5vZGUgc2hvdWxkIGJlIGluIHNpYmxpbmdzIGFycmF5Iik7bGV0IG89cysodD09PSJyaWdodCI/MTotMSk7MDw9byYmbzx0aGlzLm5hdi5zaWJsaW5ncy5sZW5ndGgmJnRoaXMuc2V0U2VsZWN0aW9uUmF3KFtdLHRoaXMubmF2LnNpYmxpbmdzW29dKX13KHRoaXMubmF2LnZpc2l0ZWQubGVuZ3RoPT09MHx8dGhpcy5uYXYuc2libGluZ3MuaW5jbHVkZXModGhpcy5uYXYudmlzaXRlZFt0aGlzLm5hdi5jdXJyZW50SW5kZXhdKSwiZXhwZWN0ZWQgY3VycmVudGx5IHZpc2l0ZWQgbm9kZSB0byBiZSBpbiB0aGUgc2libGluZ3MgYXJyYXkiKSx3KHRoaXMubGFzdFNlbGVjdGVkQmxvY2tQdHI9PT0wfHx0aGlzLm5hdi5zaWJsaW5ncy5pbmNsdWRlcyh0aGlzLmxhc3RTZWxlY3RlZEJsb2NrUHRyKSwiZXhwZWN0ZWQgY3VycmVudGx5IHNlbGVjdGVkIGJsb2NrIHRvIGJlIGluIHNpYmxpbmdzIGFycmF5Iil9dG9nZ2xlSW5zdHJ1Y3Rpb25IaWdobGlnaHQodCxlKXt0aGlzLnJlbW92ZU5vbmV4aXN0ZW50SGlnaGxpZ2h0cygpO2xldCBzPXRoaXMuaGlnaGxpZ2h0ZWRJbnN0cnVjdGlvbnMuZmluZEluZGV4KG49Pm4ucHRyPT09dCksbz1zPj0wO2lmKGUhPT12b2lkIDAmJihvPSFlKSxvKXM+PTAmJnRoaXMuaGlnaGxpZ2h0ZWRJbnN0cnVjdGlvbnMuc3BsaWNlKHMsMSk7ZWxzZSBpZihzPDApe2xldCBuPTA7Zm9yKDs7KXtpZih0aGlzLmhpZ2hsaWdodGVkSW5zdHJ1Y3Rpb25zLmZpbmQocj0+ci5wYWxldHRlQ29sb3I9PT1uKSl7bis9MTtjb250aW51ZX1icmVha310aGlzLmhpZ2hsaWdodGVkSW5zdHJ1Y3Rpb25zLnB1c2goe3B0cjp0LHBhbGV0dGVDb2xvcjpufSl9dGhpcy51cGRhdGVIaWdobGlnaHRlZEluc3RydWN0aW9ucygpfWNsYW1wVHJhbnNsYXRpb24odCxlKXtsZXQgcz1SLXRoaXMuc2l6ZS54KmUsbz10aGlzLnZpZXdwb3J0U2l6ZS54LVIsbj1SLXRoaXMuc2l6ZS55KmUscj10aGlzLnZpZXdwb3J0U2l6ZS55LVIsaT1WKHQueCxzLG8pLGw9Vih0LnksbixyKTtyZXR1cm57eDppLHk6bH19dXBkYXRlUGFuQW5kWm9vbSgpe2xldCB0PXRoaXMuY2xhbXBUcmFuc2xhdGlvbih0aGlzLnRyYW5zbGF0aW9uLHRoaXMuem9vbSk7dGhpcy5ncmFwaENvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm09YHRyYW5zbGF0ZSgke3QueH1weCwgJHt0Lnl9cHgpIHNjYWxlKCR7dGhpcy56b29tfSlgfWdyYXBoMnZpZXdwb3J0KHQsZT10aGlzLnRyYW5zbGF0aW9uLHM9dGhpcy56b29tKXtyZXR1cm57eDp0LngqcytlLngseTp0LnkqcytlLnl9fXZpZXdwb3J0MmdyYXBoKHQsZT10aGlzLnRyYW5zbGF0aW9uLHM9dGhpcy56b29tKXtyZXR1cm57eDoodC54LWUueCkvcyx5Oih0LnktZS55KS9zfX1hc3luYyBnb1RvR3JhcGhDb29yZGluYXRlcyh0LHt6b29tOmU9dGhpcy56b29tLGFuaW1hdGU6cz0hMH0pe2xldCBvPXt4Oi10LngqZSx5Oi10LnkqZX07aWYoIXMpe3RoaXMuYW5pbWF0aW5nPSExLHRoaXMudHJhbnNsYXRpb24ueD1vLngsdGhpcy50cmFuc2xhdGlvbi55PW8ueSx0aGlzLnpvb209ZSx0aGlzLnVwZGF0ZVBhbkFuZFpvb20oKSxhd2FpdCBuZXcgUHJvbWlzZShyPT5zZXRUaW1lb3V0KHIsMCkpO3JldHVybn1pZih0aGlzLnRhcmdldFRyYW5zbGF0aW9uPW8sdGhpcy50YXJnZXRab29tPWUsdGhpcy5hbmltYXRpbmcpcmV0dXJuO3RoaXMuYW5pbWF0aW5nPSEwO2xldCBuPXBlcmZvcm1hbmNlLm5vdygpO2Zvcig7dGhpcy5hbmltYXRpbmc7KXtsZXQgcj1hd2FpdCBuZXcgUHJvbWlzZShtPT5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobSkpLGk9KHItbikvMWUzO249cjtsZXQgbD0xLGM9LjAxLGg9MWUtNixkPXRoaXMudGFyZ2V0VHJhbnNsYXRpb24ueC10aGlzLnRyYW5zbGF0aW9uLngsdT10aGlzLnRhcmdldFRyYW5zbGF0aW9uLnktdGhpcy50cmFuc2xhdGlvbi55LHA9dGhpcy50YXJnZXRab29tLXRoaXMuem9vbTtpZih0aGlzLnRyYW5zbGF0aW9uLng9QSh0aGlzLnRyYW5zbGF0aW9uLngsdGhpcy50YXJnZXRUcmFuc2xhdGlvbi54LGgsaSksdGhpcy50cmFuc2xhdGlvbi55PUEodGhpcy50cmFuc2xhdGlvbi55LHRoaXMudGFyZ2V0VHJhbnNsYXRpb24ueSxoLGkpLHRoaXMuem9vbT1BKHRoaXMuem9vbSx0aGlzLnRhcmdldFpvb20saCxpKSx0aGlzLnVwZGF0ZVBhbkFuZFpvb20oKSxNYXRoLmFicyhkKTw9bCYmTWF0aC5hYnModSk8PWwmJk1hdGguYWJzKHApPD1jKXt0aGlzLnRyYW5zbGF0aW9uLng9dGhpcy50YXJnZXRUcmFuc2xhdGlvbi54LHRoaXMudHJhbnNsYXRpb24ueT10aGlzLnRhcmdldFRyYW5zbGF0aW9uLnksdGhpcy56b29tPXRoaXMudGFyZ2V0Wm9vbSx0aGlzLmFuaW1hdGluZz0hMSx0aGlzLnVwZGF0ZVBhbkFuZFpvb20oKTticmVha319YXdhaXQgbmV3IFByb21pc2Uocj0+c2V0VGltZW91dChyLDApKX1qdW1wVG9CbG9jayh0LHt6b29tOmU9dGhpcy56b29tLGFuaW1hdGU6cz0hMCx2aWV3cG9ydFBvczpvfT17fSl7bGV0IG49dGhpcy5ibG9ja3NCeVB0ci5nZXQodCk7aWYoIW4pcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO2lmKCFuLmxheW91dE5vZGUpcmV0dXJuIHRoaXMuZGVmZXJyZWRKdW1wVG9CbG9jaz17YmxvY2tQdHI6dCxvcHRzOnt6b29tOmUsYW5pbWF0ZTpzLHZpZXdwb3J0UG9zOm99fSxQcm9taXNlLnJlc29sdmUoKTtsZXQgcjtyZXR1cm4gbz9yPXt4Om4ubGF5b3V0Tm9kZS5wb3MueC1vLngvZSx5Om4ubGF5b3V0Tm9kZS5wb3MueS1vLnkvZX06cj10aGlzLmdyYXBoUG9zVG9DZW50ZXJSZWN0KG4ubGF5b3V0Tm9kZS5wb3Msbi5sYXlvdXROb2RlLnNpemUsZSksdGhpcy5nb1RvR3JhcGhDb29yZGluYXRlcyhyLHt6b29tOmUsYW5pbWF0ZTpzfSl9YXN5bmMganVtcFRvSW5zdHJ1Y3Rpb24odCx7em9vbTplPXRoaXMuem9vbSxhbmltYXRlOnM9ITB9KXtsZXQgbz10aGlzLmdyYXBoQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoYC5pZy1pbnNbZGF0YS1pZy1pbnMtaWQ9IiR7dH0iXWApO2lmKCFvKXJldHVybjtsZXQgbj1vLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLHI9dGhpcy5ncmFwaENvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxpPShuLngtci54KS90aGlzLnpvb20sbD0obi55LXIueSkvdGhpcy56b29tLGM9bi53aWR0aC90aGlzLnpvb20saD1uLmhlaWdodC90aGlzLnpvb20sZD10aGlzLmdyYXBoUG9zVG9DZW50ZXJSZWN0KHt4OmkseTpsfSx7eDpjLHk6aH0sZSk7by5jbGFzc0xpc3QuYWRkKCJpZy1mbGFzaCIpLGF3YWl0IHRoaXMuZ29Ub0dyYXBoQ29vcmRpbmF0ZXMoZCx7em9vbTplLGFuaW1hdGU6c30pLG8uY2xhc3NMaXN0LnJlbW92ZSgiaWctZmxhc2giKX1ncmFwaFBvc1RvQ2VudGVyUmVjdCh0LGUscyl7bGV0IG89dGhpcy52aWV3cG9ydFNpemUueC9zLG49dGhpcy52aWV3cG9ydFNpemUueS9zLHI9TWF0aC5tYXgoMjAvcywoby1lLngpLzIpLGk9TWF0aC5tYXgoMjAvcywobi1lLnkpLzIpLGw9dC54LXIsYz10LnktaTtyZXR1cm57eDpsLHk6Y319ZXhwb3J0U3RhdGUoKXtsZXQgdD17dHJhbnNsYXRpb246dGhpcy50cmFuc2xhdGlvbix6b29tOnRoaXMuem9vbSxoZWF0bWFwTW9kZTp0aGlzLmhlYXRtYXBNb2RlLGhpZ2hsaWdodGVkSW5zdHJ1Y3Rpb25zOnRoaXMuaGlnaGxpZ2h0ZWRJbnN0cnVjdGlvbnMsc2VsZWN0ZWRCbG9ja1B0cnM6dGhpcy5zZWxlY3RlZEJsb2NrUHRycyxsYXN0U2VsZWN0ZWRCbG9ja1B0cjp0aGlzLmxhc3RTZWxlY3RlZEJsb2NrUHRyLHZpZXdwb3J0UG9zT2ZTZWxlY3RlZEJsb2NrOnZvaWQgMH07cmV0dXJuIHRoaXMubGFzdFNlbGVjdGVkQmxvY2tQdHImJih0LnZpZXdwb3J0UG9zT2ZTZWxlY3RlZEJsb2NrPXRoaXMuZ3JhcGgydmlld3BvcnQoSSh0aGlzLmJsb2Nrc0J5UHRyLmdldCh0aGlzLmxhc3RTZWxlY3RlZEJsb2NrUHRyKSkubGF5b3V0Tm9kZS5wb3MpKSx0fXJlc3RvcmVTdGF0ZSh0LGUpe3RoaXMudHJhbnNsYXRpb24ueD10LnRyYW5zbGF0aW9uLngsdGhpcy50cmFuc2xhdGlvbi55PXQudHJhbnNsYXRpb24ueSx0aGlzLnpvb209dC56b29tLHRoaXMuaGVhdG1hcE1vZGU9dC5oZWF0bWFwTW9kZSx0aGlzLmhpZ2hsaWdodGVkSW5zdHJ1Y3Rpb25zPXQuaGlnaGxpZ2h0ZWRJbnN0cnVjdGlvbnMsdGhpcy5zZXRTZWxlY3Rpb24oQXJyYXkuZnJvbSh0LnNlbGVjdGVkQmxvY2tQdHJzKSx0Lmxhc3RTZWxlY3RlZEJsb2NrUHRyKSx0aGlzLnVwZGF0ZVBhbkFuZFpvb20oKSx0aGlzLnVwZGF0ZUhvdG5lc3MoKSx0aGlzLnVwZGF0ZUhpZ2hsaWdodGVkSW5zdHJ1Y3Rpb25zKCksZS5wcmVzZXJ2ZVNlbGVjdGVkQmxvY2tQb3NpdGlvbiYmdGhpcy5qdW1wVG9CbG9jayh0aGlzLmxhc3RTZWxlY3RlZEJsb2NrUHRyLHt6b29tOnRoaXMuem9vbSxhbmltYXRlOiExLHZpZXdwb3J0UG9zOnQudmlld3BvcnRQb3NPZlNlbGVjdGVkQmxvY2t9KX19O2Z1bmN0aW9uKlooYSl7Zm9yKGxldCB0IG9mIGEpZm9yKGxldCBlIG9mIHQpZS5ibG9jaz09PW51bGwmJih5aWVsZCBlKX1mdW5jdGlvbiBFdChhLHQsZSxzLG8sbixyPTEpe2xldCBpPSQ7ciUyPT09MSYmKGErPS41LGUrPS41LG8rPS41KTtsZXQgbD0iIjtpZihsKz1gTSAke2F9ICR7dH0gYCxNYXRoLmFicyhlLWEpPDIqaSlsKz1gQyAke2F9ICR7dCsocy10KS8zfSAke2V9ICR7dCsyKihzLXQpLzN9ICR7ZX0gJHtzfSBgO2Vsc2V7bGV0IGQ9TWF0aC5zaWduKGUtYSk7bCs9YEwgJHthfSAke28taX0gYCxsKz1gQSAke2l9ICR7aX0gMCAwICR7ZD4wPzA6MX0gJHthK2kqZH0gJHtvfSBgLGwrPWBMICR7ZS1pKmR9ICR7b30gYCxsKz1gQSAke2l9ICR7aX0gMCAwICR7ZD4wPzE6MH0gJHtlfSAke28raX0gYCxsKz1gTCAke2V9ICR7c30gYH1sZXQgYz1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwiZyIpLGg9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsInBhdGgiKTtpZihoLnNldEF0dHJpYnV0ZSgiZCIsbCksaC5zZXRBdHRyaWJ1dGUoImZpbGwiLCJub25lIiksaC5zZXRBdHRyaWJ1dGUoInN0cm9rZSIsImJsYWNrIiksaC5zZXRBdHRyaWJ1dGUoInN0cm9rZS13aWR0aCIsYCR7cn0gYCksYy5hcHBlbmRDaGlsZChoKSxuKXtsZXQgZD1YKGUscywxODApO2MuYXBwZW5kQ2hpbGQoZCl9cmV0dXJuIGN9ZnVuY3Rpb24gJHQoYSx0LGUscyxvLG4scj0xKXtsZXQgaT0kO3IlMj09PTEmJihhKz0uNSxlKz0uNSxvKz0uNSk7bGV0IGw9IiI7aWYobCs9YE0gJHthfSAke3R9IGAsTWF0aC5hYnMoZS1hKTwyKmkpbCs9YEMgJHthfSAke3QrKHMtdCkvM30gJHtlfSAke3QrMioocy10KS8zfSAke2V9ICR7c30gYDtlbHNle2xldCBkPU1hdGguc2lnbihlLWEpO2wrPWBMICR7YX0gJHtvK2l9IGAsbCs9YEEgJHtpfSAke2l9IDAgMCAke2Q+MD8xOjB9ICR7YStpKmR9ICR7b30gYCxsKz1gTCAke2UtaSpkfSAke299IGAsbCs9YEEgJHtpfSAke2l9IDAgMCAke2Q+MD8wOjF9ICR7ZX0gJHtvLWl9IGAsbCs9YEwgJHtlfSAke3N9IGB9bGV0IGM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsImciKSxoPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCJwYXRoIik7aWYoaC5zZXRBdHRyaWJ1dGUoImQiLGwpLGguc2V0QXR0cmlidXRlKCJmaWxsIiwibm9uZSIpLGguc2V0QXR0cmlidXRlKCJzdHJva2UiLCJibGFjayIpLGguc2V0QXR0cmlidXRlKCJzdHJva2Utd2lkdGgiLGAke3J9IGApLGMuYXBwZW5kQ2hpbGQoaCksbil7bGV0IGQ9WChlLHMsMCk7Yy5hcHBlbmRDaGlsZChkKX1yZXR1cm4gY31mdW5jdGlvbiBIdChhLHQsZSxzLG8sbj0xKXtsZXQgcj0kO24lMj09PTEmJihhKz0uNSxlKz0uNSxvKz0uNSk7bGV0IGk9IiI7aSs9YE0gJHthfSAke3R9IGAsaSs9YEwgJHthfSAke28tcn0gYCxpKz1gQSAke3J9ICR7cn0gMCAwIDAgJHthK3J9ICR7b30gYCxpKz1gTCAke2Utcn0gJHtvfSBgLGkrPWBBICR7cn0gJHtyfSAwIDAgMCAke2V9ICR7by1yfSBgLGkrPWBMICR7ZX0gJHtzfSBgO2xldCBsPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCJnIiksYz1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwicGF0aCIpO3JldHVybiBjLnNldEF0dHJpYnV0ZSgiZCIsaSksYy5zZXRBdHRyaWJ1dGUoImZpbGwiLCJub25lIiksYy5zZXRBdHRyaWJ1dGUoInN0cm9rZSIsImJsYWNrIiksYy5zZXRBdHRyaWJ1dGUoInN0cm9rZS13aWR0aCIsYCR7bn0gYCksbC5hcHBlbmRDaGlsZChjKSxsfWZ1bmN0aW9uIEF0KGEsdCxlLHMsbyxuPTEpe2xldCByPSQ7biUyPT09MSYmKGErPS41LGUrPS41LHQrPS41LHMrPS41LG8rPS41KTtsZXQgaT0iIjtpKz1gTSAke2F9ICR7dH0gYCxpKz1gTCAke2F9ICR7bytyfSBgLGkrPWBBICR7cn0gJHtyfSAwIDAgMCAke2Etcn0gJHtvfSBgLGkrPWBMICR7ZStyfSAke299IGAsaSs9YEEgJHtyfSAke3J9IDAgMCAwICR7ZX0gJHtvK3J9IGAsaSs9YEwgJHtlfSAke3N9IGA7bGV0IGw9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsImciKSxjPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCJwYXRoIik7Yy5zZXRBdHRyaWJ1dGUoImQiLGkpLGMuc2V0QXR0cmlidXRlKCJmaWxsIiwibm9uZSIpLGMuc2V0QXR0cmlidXRlKCJzdHJva2UiLCJibGFjayIpLGMuc2V0QXR0cmlidXRlKCJzdHJva2Utd2lkdGgiLGAke259IGApLGwuYXBwZW5kQ2hpbGQoYyk7bGV0IGg9WChlLHMsMTgwKTtyZXR1cm4gbC5hcHBlbmRDaGlsZChoKSxsfWZ1bmN0aW9uIFgoYSx0LGUscz01KXtsZXQgbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwicGF0aCIpO3JldHVybiBvLnNldEF0dHJpYnV0ZSgiZCIsYE0gMCAwIEwgJHstc30gJHtzKjEuNX0gTCAke3N9ICR7cyoxLjV9IFpgKSxvLnNldEF0dHJpYnV0ZSgidHJhbnNmb3JtIixgdHJhbnNsYXRlKCR7YX0sICR7dH0pIHJvdGF0ZSgke2V9KWApLG99ZnVuY3Rpb24gb3QoYSx0KXthLmNsYXNzTGlzdC5hZGQoImlnLWhpZ2hsaWdodCIpLGEuc3R5bGUuc2V0UHJvcGVydHkoIi0taWctaGlnaGxpZ2h0LWNvbG9yIix0KX1mdW5jdGlvbiBPdChhKXthLmNsYXNzTGlzdC5yZW1vdmUoImlnLWhpZ2hsaWdodCIpLGEuc3R5bGUuc2V0UHJvcGVydHkoIi0taWctaGlnaGxpZ2h0LWNvbG9yIiwidHJhbnNwYXJlbnQiKX12YXIgSD1jbGFzc3tjb25zdHJ1Y3Rvcih0LHtmdW5jOmUscGFzczpzPTAsc2FtcGxlQ291bnRzOm99KXt0aGlzLmdyYXBoPW51bGwsdGhpcy5mdW5jPWUsdGhpcy5wYXNzTnVtYmVyPXMsdGhpcy5zYW1wbGVDb3VudHM9byx0aGlzLmtleVBhc3Nlcz1bbnVsbCxudWxsLG51bGwsbnVsbF07e2xldCBuPW51bGw7Zm9yKGxldFtyLGldb2YgZS5wYXNzZXMuZW50cmllcygpKWkubWlyLmJsb2Nrcy5sZW5ndGg+MCYmKHRoaXMua2V5UGFzc2VzWzBdPT09bnVsbCYmKHRoaXMua2V5UGFzc2VzWzBdPXIpLGkubGlyLmJsb2Nrcy5sZW5ndGg9PT0wJiYodGhpcy5rZXlQYXNzZXNbMV09cikpLGkubGlyLmJsb2Nrcy5sZW5ndGg+MCYmKG4/Lmxpci5ibG9ja3MubGVuZ3RoPT09MCYmKHRoaXMua2V5UGFzc2VzWzJdPXIpLHRoaXMua2V5UGFzc2VzWzNdPXIpLG49aX10aGlzLnJlZHVuZGFudFBhc3Nlcz1bXTt7bGV0IG49bnVsbDtmb3IobGV0W3IsaV1vZiBlLnBhc3Nlcy5lbnRyaWVzKCkpe2lmKG49PT1udWxsKXtuPWk7Y29udGludWV9QyhuLm1pcixpLm1pcikmJkMobi5saXIsaS5saXIpJiZ0aGlzLnJlZHVuZGFudFBhc3Nlcy5wdXNoKHIpLG49aX19dGhpcy52aWV3cG9ydD1iKCJkaXYiLFsiaWctZmxleC1ncm93LTEiLCJpZy1vdmVyZmxvdy1oaWRkZW4iXSxuPT57bi5zdHlsZS5wb3NpdGlvbj0icmVsYXRpdmUifSksdGhpcy5zaWRlYmFyTGlua3M9ZS5wYXNzZXMubWFwKChuLHIpPT5iKCJhIixbImlnLWxpbmstbm9ybWFsIiwiaWctcHYxIiwiaWctcGgyIiwiaWctZmxleCIsImlnLWcyIl0saT0+e2kuaHJlZj0iIyIsaS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsbD0+e2wucHJldmVudERlZmF1bHQoKSx0aGlzLnN3aXRjaFBhc3Mocil9KSxpLnN0eWxlLm1pbldpZHRoPSIxMDAlIn0sW2IoImRpdiIsWyJpZy13MSIsImlnLXRyIiwiaWctZjYiLCJpZy10ZXh0LWRpbSJdLGk9PntpLnN0eWxlLnBhZGRpbmdUb3A9IjAuMDhyZW0iLGkuc3R5bGUuZmxleFNocmluaz0iMCJ9LFtgJHtyfWBdKSxiKCJkaXYiLFt0aGlzLnJlZHVuZGFudFBhc3Nlcy5pbmNsdWRlcyhyKSYmImlnLXRleHQtZGltIl0saT0+e2kuc3R5bGUud2hpdGVTcGFjZT0ibm93cmFwIn0sW24ubmFtZV0pXSkpLHRoaXMuY29udGFpbmVyPWIoImRpdiIsWyJpZy1hYnNvbHV0ZSIsImlnLWFic29sdXRlLWZpbGwiLCJpZy1mbGV4Il0sKCk9Pnt9LFtiKCJkaXYiLFsiaWctdzUiLCJpZy1iciIsImlnLWZsZXgtc2hyaW5rLTAiLCJpZy1vdmVyZmxvdy15LWF1dG8iLCJpZy1iZy13aGl0ZSJdLG49PntuLnN0eWxlLm92ZXJmbG93WD0iYXV0byJ9LFsuLi50aGlzLnNpZGViYXJMaW5rc10pLHRoaXMudmlld3BvcnRdKSx0LmFwcGVuZENoaWxkKHRoaXMuY29udGFpbmVyKSx0aGlzLmtleWRvd25IYW5kbGVyPXRoaXMua2V5ZG93bkhhbmRsZXIuYmluZCh0aGlzKSx0aGlzLnR3ZWFrSGFuZGxlcj10aGlzLnR3ZWFrSGFuZGxlci5iaW5kKHRoaXMpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJrZXlkb3duIix0aGlzLmtleWRvd25IYW5kbGVyKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigidHdlYWsiLHRoaXMudHdlYWtIYW5kbGVyKSx0aGlzLnVwZGF0ZSgpfWRlc3Ryb3koKXt0aGlzLmNvbnRhaW5lci5yZW1vdmUoKSx3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsdGhpcy5rZXlkb3duSGFuZGxlciksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInR3ZWFrIix0aGlzLnR3ZWFrSGFuZGxlcil9dXBkYXRlKCl7Zm9yKGxldFtzLG9db2YgdGhpcy5zaWRlYmFyTGlua3MuZW50cmllcygpKW8uY2xhc3NMaXN0LnRvZ2dsZSgiaWctYmctcHJpbWFyeSIsdGhpcy5wYXNzTnVtYmVyPT09cyk7bGV0IHQ9dGhpcy5ncmFwaD8uZXhwb3J0U3RhdGUoKTt0aGlzLnZpZXdwb3J0LmlubmVySFRNTD0iIix0aGlzLmdyYXBoPW51bGw7bGV0IGU9dGhpcy5mdW5jLnBhc3Nlc1t0aGlzLnBhc3NOdW1iZXJdO2lmKGUpdHJ5e3RoaXMuZ3JhcGg9bmV3IEYodGhpcy52aWV3cG9ydCxlLHtzYW1wbGVDb3VudHM6dGhpcy5zYW1wbGVDb3VudHN9KSx0JiZ0aGlzLmdyYXBoLnJlc3RvcmVTdGF0ZSh0LHtwcmVzZXJ2ZVNlbGVjdGVkQmxvY2tQb3NpdGlvbjohMH0pfWNhdGNoKHMpe3RoaXMudmlld3BvcnQuaW5uZXJIVE1MPSJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBsYXlpbmcgb3V0IHRoZSBncmFwaC4gU2VlIGNvbnNvbGUuIixjb25zb2xlLmVycm9yKHMpfX1zd2l0Y2hQYXNzKHQpe3RoaXMucGFzc051bWJlcj10LHRoaXMudXBkYXRlKCl9a2V5ZG93bkhhbmRsZXIodCl7c3dpdGNoKHQua2V5KXtjYXNlInciOmNhc2UicyI6dGhpcy5ncmFwaD8ubmF2aWdhdGUodC5rZXk9PT0icyI/ImRvd24iOiJ1cCIpLHRoaXMuZ3JhcGg/Lmp1bXBUb0Jsb2NrKHRoaXMuZ3JhcGgubGFzdFNlbGVjdGVkQmxvY2tQdHIpO2JyZWFrO2Nhc2UiYSI6Y2FzZSJkIjp0aGlzLmdyYXBoPy5uYXZpZ2F0ZSh0LmtleT09PSJkIj8icmlnaHQiOiJsZWZ0IiksdGhpcy5ncmFwaD8uanVtcFRvQmxvY2sodGhpcy5ncmFwaC5sYXN0U2VsZWN0ZWRCbG9ja1B0cik7YnJlYWs7Y2FzZSJmIjpmb3IobGV0IGU9dGhpcy5wYXNzTnVtYmVyKzE7ZTx0aGlzLmZ1bmMucGFzc2VzLmxlbmd0aDtlKyspaWYoIXRoaXMucmVkdW5kYW50UGFzc2VzLmluY2x1ZGVzKGUpKXt0aGlzLnN3aXRjaFBhc3MoZSk7YnJlYWt9YnJlYWs7Y2FzZSJyIjpmb3IobGV0IGU9dGhpcy5wYXNzTnVtYmVyLTE7ZT49MDtlLS0paWYoIXRoaXMucmVkdW5kYW50UGFzc2VzLmluY2x1ZGVzKGUpKXt0aGlzLnN3aXRjaFBhc3MoZSk7YnJlYWt9YnJlYWs7Y2FzZSIxIjpjYXNlIjIiOmNhc2UiMyI6Y2FzZSI0Ijp7bGV0IGU9WyIxIiwiMiIsIjMiLCI0Il0uaW5kZXhPZih0LmtleSkscz10aGlzLmtleVBhc3Nlc1tlXTt0eXBlb2Ygcz09Im51bWJlciImJnRoaXMuc3dpdGNoUGFzcyhzKX1icmVhaztjYXNlImMiOntsZXQgZT10aGlzLmdyYXBoPy5ibG9ja3NCeVB0ci5nZXQodGhpcy5ncmFwaD8ubGFzdFNlbGVjdGVkQmxvY2tQdHI/Py0xKTtlJiZ0aGlzLmdyYXBoPy5qdW1wVG9CbG9jayhlLnB0cix7em9vbToxfSl9YnJlYWt9fXR3ZWFrSGFuZGxlcigpe3RoaXMudXBkYXRlKCl9fTt2YXIgUz1uZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi50b1N0cmluZygpKS5zZWFyY2hQYXJhbXMsUnQ9Uy5oYXMoImZ1bmMiKT9wYXJzZUludChTLmdldCgiZnVuYyIpLDEwKTp2b2lkIDAscnQ9Uy5oYXMoInBhc3MiKT9wYXJzZUludChTLmdldCgicGFzcyIpLDEwKTp2b2lkIDAsej1jbGFzc3tjb25zdHJ1Y3Rvcih0KXt0aGlzLmV4cG9ydEJ1dHRvbj1udWxsLHRoaXMuaW9uanNvbj1udWxsLHRoaXMuZnVuY0luZGV4PVJ0Pz8wLHRoaXMuZnVuY1NlbGVjdGVkPXQuZnVuY1NlbGVjdGVkLHRoaXMuZnVuY1NlbGVjdG9yPWIoImRpdiIsW10sKCk9Pnt9LFsiRnVuY3Rpb24iLGIoImlucHV0IixbImlnLXczIl0sZT0+e2UudHlwZT0ibnVtYmVyIixlLm1pbj0iMSIsZS5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsKCk9Pnt0aGlzLnN3aXRjaEZ1bmMocGFyc2VJbnQoZS52YWx1ZSwxMCktMSl9KX0sW10pLCIgLyAiLGIoInNwYW4iLFsibnVtLWZ1bmN0aW9ucyJdKV0pLHRoaXMuZnVuY1NlbGVjdG9yTm9uZT1iKCJkaXYiLFtdLCgpPT57fSxbIk5vIGZ1bmN0aW9ucyB0byBkaXNwbGF5LiJdKSx0aGlzLmZ1bmNOYW1lPWIoImRpdiIpLHRoaXMucm9vdD1iKCJkaXYiLFsiaWctYmIiLCJpZy1mbGV4IiwiaWctYmctd2hpdGUiXSwoKT0+e30sW2IoImRpdiIsWyJpZy1wdjIiLCJpZy1waDMiLCJpZy1mbGV4IiwiaWctZzIiLCJpZy1pdGVtcy1jZW50ZXIiLCJpZy1iciIsImlnLWhpZGUtaWYtZW1wdHkiXSwoKT0+e30sW3QuYnJvd3NlJiZiKCJkaXYiLFtdLCgpPT57fSxbYigiaW5wdXQiLFtdLGU9PntlLnR5cGU9ImZpbGUiLGUuYWRkRXZlbnRMaXN0ZW5lcigiY2hhbmdlIixzPT57bGV0IG89cy50YXJnZXQ7by5maWxlcz8ubGVuZ3RoJiZ0aGlzLmZpbGVTZWxlY3RlZChvLmZpbGVzWzBdKX0pfSldKSx0aGlzLmZ1bmNTZWxlY3Rvcix0aGlzLmZ1bmNTZWxlY3Rvck5vbmVdKSxiKCJkaXYiLFsiaWctZmxleC1ncm93LTEiLCJpZy1wdjIiLCJpZy1waDMiLCJpZy1mbGV4IiwiaWctZzIiLCJpZy1pdGVtcy1jZW50ZXIiXSwoKT0+e30sW3RoaXMuZnVuY05hbWUsYigiZGl2IixbImlnLWZsZXgtZ3Jvdy0xIl0pLHQuZXhwb3J0JiZiKCJkaXYiLFtdLCgpPT57fSxbYigiYnV0dG9uIixbXSxlPT57dGhpcy5leHBvcnRCdXR0b249ZSxlLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoKT0+e3RoaXMuZXhwb3J0U3RhbmRhbG9uZSgpfSl9LFsiRXhwb3J0Il0pXSldKV0pLHRoaXMudXBkYXRlKCl9YXN5bmMgZmlsZVNlbGVjdGVkKHQpe2xldCBlPUpTT04ucGFyc2UoYXdhaXQgdC50ZXh0KCkpO3RoaXMuaW9uanNvbj1qKGUpLHRoaXMuc3dpdGNoRnVuYygwKSx0aGlzLnVwZGF0ZSgpfXN3aXRjaElvbkpTT04odCl7dGhpcy5pb25qc29uPXQsdGhpcy5zd2l0Y2hGdW5jKHRoaXMuZnVuY0luZGV4KX1zd2l0Y2hGdW5jKHQpe3Q9TWF0aC5tYXgoMCxNYXRoLm1pbih0aGlzLm51bUZ1bmN0aW9ucygpLTEsdCkpLHRoaXMuZnVuY0luZGV4PWlzTmFOKHQpPzA6dCx0aGlzLmZ1bmNTZWxlY3RlZCh0aGlzLmlvbmpzb24/LmZ1bmN0aW9uc1t0aGlzLmZ1bmNJbmRleF0/P251bGwpLHRoaXMudXBkYXRlKCl9bnVtRnVuY3Rpb25zKCl7cmV0dXJuIHRoaXMuaW9uanNvbj8uZnVuY3Rpb25zLmxlbmd0aD8/MH11cGRhdGUoKXtsZXQgdD0wPD10aGlzLmZ1bmNJbmRleCYmdGhpcy5mdW5jSW5kZXg8dGhpcy5udW1GdW5jdGlvbnMoKTt0aGlzLmZ1bmNTZWxlY3Rvci5oaWRkZW49dGhpcy5udW1GdW5jdGlvbnMoKTw9MSx0aGlzLmZ1bmNTZWxlY3Rvck5vbmUuaGlkZGVuPSEodGhpcy5pb25qc29uJiZ0aGlzLm51bUZ1bmN0aW9ucygpPT09MCk7bGV0IGU9dGhpcy5mdW5jU2VsZWN0b3IucXVlcnlTZWxlY3RvcigiaW5wdXQiKTtlLm1heD1gJHt0aGlzLm51bUZ1bmN0aW9ucygpfWAsZS52YWx1ZT1gJHt0aGlzLmZ1bmNJbmRleCsxfWAsdGhpcy5mdW5jU2VsZWN0b3IucXVlcnlTZWxlY3RvcigiLm51bS1mdW5jdGlvbnMiKS5pbm5lckhUTUw9YCR7dGhpcy5udW1GdW5jdGlvbnMoKX1gLHRoaXMuZnVuY05hbWUuaGlkZGVuPSF0LHRoaXMuZnVuY05hbWUuaW5uZXJUZXh0PWAke3RoaXMuaW9uanNvbj8uZnVuY3Rpb25zW3RoaXMuZnVuY0luZGV4XS5uYW1lPz8iIn1gLHRoaXMuZXhwb3J0QnV0dG9uJiYodGhpcy5leHBvcnRCdXR0b24uZGlzYWJsZWQ9IXRoaXMuaW9uanNvbnx8IXQpfWFzeW5jIGV4cG9ydFN0YW5kYWxvbmUoKXtsZXQgdD1JKHRoaXMuaW9uanNvbiksZT10LmZ1bmN0aW9uc1t0aGlzLmZ1bmNJbmRleF0ubmFtZSxzPXt2ZXJzaW9uOjEsZnVuY3Rpb25zOlt0LmZ1bmN0aW9uc1t0aGlzLmZ1bmNJbmRleF1dfSxuPSh3aW5kb3cuX19zdGFuZGFsb25lVGVtcGxhdGU/P2F3YWl0KGF3YWl0IGZldGNoKCIuL3N0YW5kYWxvbmUuaHRtbCIpKS50ZXh0KCkpLnJlcGxhY2UoL1x7XHtccypJT05KU09OXHMqXH1cfS8sSlNPTi5zdHJpbmdpZnkocykpLHI9VVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbbl0se3R5cGU6InRleHQvaHRtbDtjaGFyc2V0PXV0Zi04In0pKSxpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTtpLmhyZWY9cixpLmRvd25sb2FkPWBpb25ncmFwaC0ke2V9Lmh0bWxgLGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaSksaS5jbGljaygpLGkucmVtb3ZlKCksVVJMLnJldm9rZU9iamVjdFVSTChyKX19LFU9Y2xhc3N7Y29uc3RydWN0b3IoKXt0aGlzLm1lbnVCYXI9bmV3IHooe2Jyb3dzZTohMCxleHBvcnQ6ITAsZnVuY1NlbGVjdGVkOnQ9PnRoaXMuc3dpdGNoRnVuYyh0KX0pLHRoaXMuZnVuYz1udWxsLHRoaXMuc2FtcGxlQ291bnRzRnJvbUZpbGU9dm9pZCAwLHRoaXMuZ3JhcGg9bnVsbCx0aGlzLmxvYWRTdHVmZkZyb21RdWVyeVBhcmFtcygpLHRoaXMuZ3JhcGhDb250YWluZXI9YigiZGl2IixbImlnLXJlbGF0aXZlIiwiaWctZmxleC1iYXNpcy0wIiwiaWctZmxleC1ncm93LTEiLCJpZy1vdmVyZmxvdy1oaWRkZW4iXSksdGhpcy5yb290PWIoImRpdiIsWyJpZy1hYnNvbHV0ZSIsImlnLWFic29sdXRlLWZpbGwiLCJpZy1mbGV4IiwiaWctZmxleC1jb2x1bW4iXSx0PT57dC5hZGRFdmVudExpc3RlbmVyKCJkcmFnZW50ZXIiLGU9PntlLnByZXZlbnREZWZhdWx0KCksZS5zdG9wUHJvcGFnYXRpb24oKX0pLHQuYWRkRXZlbnRMaXN0ZW5lcigiZHJhZ292ZXIiLGU9PntlLnByZXZlbnREZWZhdWx0KCksZS5zdG9wUHJvcGFnYXRpb24oKX0pLHQuYWRkRXZlbnRMaXN0ZW5lcigiZHJvcCIsZT0+e2UucHJldmVudERlZmF1bHQoKSxlLnN0b3BQcm9wYWdhdGlvbigpO2xldCBzPWUuZGF0YVRyYW5zZmVyPy5maWxlcztzJiZzLmxlbmd0aD4wJiZ0aGlzLm1lbnVCYXIuZmlsZVNlbGVjdGVkKHNbMF0pfSl9LFt0aGlzLm1lbnVCYXIucm9vdCx0aGlzLmdyYXBoQ29udGFpbmVyXSksdGhpcy51cGRhdGUoKX11cGRhdGUoKXt0aGlzLmdyYXBoJiZ0aGlzLmdyYXBoLmRlc3Ryb3koKSx0aGlzLmZ1bmMmJih0aGlzLmdyYXBoPW5ldyBIKHRoaXMuZ3JhcGhDb250YWluZXIse2Z1bmM6dGhpcy5mdW5jLHBhc3M6cnQsc2FtcGxlQ291bnRzOnRoaXMuc2FtcGxlQ291bnRzRnJvbUZpbGV9KSl9bG9hZFN0dWZmRnJvbVF1ZXJ5UGFyYW1zKCl7KGFzeW5jKCk9PntsZXQgdD1TLmdldCgiZmlsZSIpO2lmKHQpe2xldCBzPWF3YWl0KGF3YWl0IGZldGNoKHQpKS5qc29uKCksbz1qKHMpO3RoaXMubWVudUJhci5zd2l0Y2hJb25KU09OKG8pfX0pKCksKGFzeW5jKCk9PntsZXQgdD1TLmdldCgic2FtcGxlQ291bnRzIik7aWYodCl7bGV0IHM9YXdhaXQoYXdhaXQgZmV0Y2godCkpLmpzb24oKTt0aGlzLnNhbXBsZUNvdW50c0Zyb21GaWxlPXtzZWxmTGluZUhpdHM6bmV3IE1hcChzLnNlbGZMaW5lSGl0cyksdG90YWxMaW5lSGl0czpuZXcgTWFwKHMudG90YWxMaW5lSGl0cyl9LHRoaXMudXBkYXRlKCl9fSkoKX1zd2l0Y2hGdW5jKHQpe3RoaXMuZnVuYz10LHRoaXMudXBkYXRlKCl9fSxxPWNsYXNze2NvbnN0cnVjdG9yKCl7dGhpcy5tZW51QmFyPW5ldyB6KHtmdW5jU2VsZWN0ZWQ6dD0+dGhpcy5zd2l0Y2hGdW5jKHQpfSksdGhpcy5mdW5jPW51bGwsdGhpcy5ncmFwaD1udWxsLHRoaXMuZ3JhcGhDb250YWluZXI9YigiZGl2IixbImlnLXJlbGF0aXZlIiwiaWctZmxleC1iYXNpcy0wIiwiaWctZmxleC1ncm93LTEiLCJpZy1vdmVyZmxvdy1oaWRkZW4iXSksdGhpcy5yb290PWIoImRpdiIsWyJpZy1hYnNvbHV0ZSIsImlnLWFic29sdXRlLWZpbGwiLCJpZy1mbGV4IiwiaWctZmxleC1jb2x1bW4iXSwoKT0+e30sW3RoaXMubWVudUJhci5yb290LHRoaXMuZ3JhcGhDb250YWluZXJdKX11cGRhdGUoKXt0aGlzLmdyYXBoJiZ0aGlzLmdyYXBoLmRlc3Ryb3koKSx0aGlzLmZ1bmMmJih0aGlzLmdyYXBoPW5ldyBIKHRoaXMuZ3JhcGhDb250YWluZXIse2Z1bmM6dGhpcy5mdW5jLHBhc3M6cnR9KSl9c2V0SW9uSlNPTih0KXt0aGlzLm1lbnVCYXIuc3dpdGNoSW9uSlNPTih0KX1zd2l0Y2hGdW5jKHQpe3RoaXMuZnVuYz10LHRoaXMudXBkYXRlKCl9fTtyZXR1cm4gbXQoRHQpO30pKCk7Cjwvc2NyaXB0PgogIDxzY3JpcHQ+d2luZG93Ll9fZXhwb3J0ZWRJb25KU09OID0ge3sgSU9OSlNPTiB9fTwvc2NyaXB0PgogIDxzY3JpcHQ+CiAgICBjb25zdCB1aSA9IG5ldyBpb25ncmFwaC5TdGFuZGFsb25lVUkoKTsKICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodWkucm9vdCk7CiAgICB1aS5zZXRJb25KU09OKHdpbmRvdy5fX2V4cG9ydGVkSW9uSlNPTik7CiAgPC9zY3JpcHQ+CjwvYm9keT4K");
  </script>
  <script>
    const ui = new iongraph.WebUI();
    document.body.appendChild(ui.root);
  </script>
</body>
