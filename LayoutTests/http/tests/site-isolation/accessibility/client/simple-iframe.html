<html><!-- webkit-test-runner [ SiteIsolationEnabled=true ] -->
<head>
<script src="/js-test-resources/js-test.js"></script>
<script src="/js-test-resources/accessibility-helper.js"></script>
</head>
<body>

<button>Before</button>
  
<iframe id="iframe" src="http://localhost:8000/site-isolation/resources/iframe.html"></iframe>

<button>After</button>

<script>
var output = "Dump accessibility tree with isolated iframe\n";

if (window.accessibilityController) {
    window.jsTestIsAsync = true;
    accessibilityController.setClientAccessibilityMode(true);

    setTimeout(async function() {
        // Wait for both a button and heading to appear in the accessibility tree.
        await waitForElements([
            (element) => element.role.includes("Button"),
            (element) => element.role.includes("Heading"),
        ]);

        const [success, resultString] = dumpAccessibilityTree(/* root = */ accessibilityController.rootElement,
                                                              /* stop = */ null,
                                                              /* indent */ 0,
                                                              /* allAttributesIfNeeded */ false,
                                                              /* getValueFromTitle */ true,
                                                              /* includeSubrole */ false);
        output += resultString;
        debug(output);
        finishJSTest();
    }, 0);
}
</script>
</body>
</html>
